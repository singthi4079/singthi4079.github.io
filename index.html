<!doctype html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="Blue的博客">
<meta property="og:url" content="https://singthi4079.github.io/index.html">
<meta property="og:site_name" content="Blue的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Blue的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://singthi4079.github.io/"/>





  <title> Blue的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blue的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/12/04/Java面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/04/Java面试题/" itemprop="url">
                  Java面试题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-04T12:12:36+08:00">
                2017-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a><strong>基本概念</strong></h2><p>操作系统中 heap 和 stack 的区别<br>什么是基于注解的切面实现<br>什么是 对象/关系 映射集成模块<br>什么是 Java 的反射机制<br>什么是 ACID<br>BS与CS的联系与区别<br>Cookie 和 Session的区别<br>fail-fast 与 fail-safe 机制有什么区别<br>get 和 post请求的区别<br>Interface 与 abstract 类的区别<br>IOC的优点是什么<br>IO 和 NIO的区别，NIO优点<br>Java 8 / Java 7 为我们提供了什么新功能<br>什么是竞态条件？ 举个例子说明。<br>JRE、JDK、JVM 及 JIT 之间有什么不同<br>MVC的各个部分都有那些技术来实现?如何实现?<br>RPC 通信和 RMI 区别<br>什么是 Web Service（Web服务）<br>JSWDL开发包的介绍。JAXP、JAXM的解释。SOAP、UDDI,WSDL解释。<br>WEB容器主要有哪些功能? 并请列出一些常见的WEB容器名字。<br>一个”.java”源文件中是否可以包含多个类（不是内部类）？有什么限制<br>简单说说你了解的类加载器。是否实现过类加载器<br>解释一下什么叫AOP（面向切面编程）<br>请简述 Servlet 的生命周期及其相关的方法<br>请简述一下 Ajax 的原理及实现步骤<br>简单描述Struts的主要功能<br>什么是 N 层架构<br>什么是CORBA？用途是什么<br>什么是Java虚拟机？为什么Java被称作是“平台无关的编程语言”<br>什么是正则表达式？用途是什么？哪个包使用正则表达式来实现模式匹配<br>什么是懒加载（Lazy Loading）<br>什么是尾递归，为什么需要尾递归<br>什么是控制反转（Inversion of Control）与依赖注入（Dependency Injection）</p>
<h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a><strong>关键字</strong></h2><p>finalize</p>
<p>什么是finalize()方法<br>finalize()方法什么时候被调用<br>析构函数(finalization)的目的是什么<br>final 和 finalize 的区别<br>final<br>final关键字有哪些用法<br>final 与 static 关键字可以用于哪里？它们的作用是什么<br>final, finally, finalize的区别<br>final、finalize 和 finally 的不同之处？<br>能否在运行时向 static final 类型的赋值<br>使用final关键字修饰一个变量时，是引用不能变，还是引用的对象不能变<br>一个类被声明为final类型，表示了什么意思<br>throws, throw, try, catch, finally分别代表什么意义<br>Java 有几种修饰符？分别用来修饰什么<br>volatile<br>JAVA架构进阶群: 678779467<br>volatile 修饰符的有过什么实践<br>volatile 变量是什么？volatile 变量和 atomic 变量有什么不同<br>volatile 类型变量提供什么保证？能使得一个非原子操作变成原子操作吗<br>能创建 volatile 数组吗？<br>transient变量有什么特点<br>super什么时候使用<br>public static void 写成 static public void会怎样<br>说明一下public static void main(String args[])这段声明里每个关键字的作用<br>请说出作用域public, private, protected, 以及不写时的区别<br>sizeof 是Java 的关键字吗<br>static</p>
<p>static class 与 non static class的区别<br>static 关键字是什么意思？Java中是否可以覆盖(override)一个private或者是static的方法<br>静态类型有什么特点<br>main() 方法为什么必须是静态的？能不能声明 main() 方法为非静态<br>是否可以从一个静态（static）方法内部发出对非静态（non-static）方法的调用<br>静态变量在什么时候加载？编译期还是运行期？静态代码块加载的时机呢<br>成员方法是否可以访问静态变量？为什么静态方法不能访问成员变量<br>switch<br>JAVA架构进阶群: 678779467<br>switch 语句中的表达式可以是什么类型数据<br>switch 是否能作用在byte 上，是否能作用在long 上，是否能作用在String上<br>while 循环和 do 循环有什么不同</p>
<h2 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a><strong>操作符</strong></h2><p>&amp;操作符和&amp;&amp;操作符有什么区别?<br>a = a + b 与 a += b 的区别？<br>逻辑操作符 (&amp;,|,^)与条件操作符(&amp;&amp;,||)的区别<br>3*0.1 == 0.3 将会返回什么？true 还是 false？<br>float f=3.4; 是否正确？<br>short s1 = 1; s1 = s1 + 1;有什么错?</p>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a><strong>数据结构</strong></h2><p>基础类型(Primitives)</p>
<p>基础类型(Primitives)与封装类型(Wrappers)的区别在哪里<br>简述九种基本数据类型的大小，以及他们的封装类<br>int 和 Integer 哪个会占用更多的内存？ int 和 Integer 有什么区别？parseInt()函数在什么时候使用到<br>float和double的默认值是多少<br>如何去小数四舍五入保留小数点后两位<br>char 型变量中能不能存贮一个中文汉字，为什么<br>类型转换</p>
<p>怎样将 bytes 转换为 long 类型<br>怎么将 byte 转换为 String<br>如何将数值型字符转换为数字<br>我们能将 int 强制转换为 byte 类型的变量吗？如果该值大于 byte 类型的范围，将会出现什么现象<br>能在不进行强制转换的情况下将一个 double 值赋值给 long 类型的变量吗<br>类型向下转换是什么<br>数组</p>
<p>如何权衡是使用无序的数组还是有序的数组<br>怎么判断数组是 null 还是为空<br>怎么打印数组？ 怎样打印数组中的重复元素<br>Array 和 ArrayList有什么区别？什么时候应该使用Array而不是ArrayList<br>数组和链表数据结构描述，各自的时间复杂度<br>数组有没有length()这个方法? String有没有length()这个方法<br>队列</p>
<p>队列和栈是什么，列出它们的区别<br>BlockingQueue是什么<br>简述 ConcurrentLinkedQueue LinkedBlockingQueue 的用处和不同之处。<br>ArrayList、Vector、LinkedList的存储性能和特性<br>String<br>StringBuffer</p>
<p>ByteBuffer 与 StringBuffer有什么区别<br>HashMap</p>
<p>内部的数据结构是什么<br>HashMap 的 table的容量如何确定？loadFactor 是什么？ 该容量如何变化？这种变化会带来什么问题？<br>HashMap 实现的数据结构是什么？如何实现<br>HashMap 和 HashTable、ConcurrentHashMap 的区别<br>HashMap的遍历方式及效率<br>HashMap、LinkedMap、TreeMap的区别<br>如何决定选用HashMap还是TreeMap<br>如果HashMap的大小超过了负载因子(load factor)定义的容量，怎么办<br>HashMap 是线程安全的吗？并发下使用的 Map 是什么，它们内部原理分别是什么，比如存储方式、 hashcode、扩容、 默认容量等<br>HashSet</p>
<p>HashSet和TreeSet有什么区别<br>HashSet 内部是如何工作的<br>WeakHashMap 是怎么工作的？<br>Set</p>
<p>Set 里的元素是不能重复的，那么用什么方法来区分重复与否呢？是用 == 还是 equals()？ 它们有何区别?<br>TreeMap：TreeMap 是采用什么树实现的？TreeMap、HashMap、LindedHashMap的区别。TreeMap和TreeSet在排序时如何比较元素？Collections工具类中的sort()方法如何比较元素？<br>TreeSet：一个已经构建好的 TreeSet，怎么完成倒排序。<br>EnumSet 是什么<br>Hash算法<br>JAVA架构进阶群: 678779467<br>Hashcode 的作用<br>简述一致性 Hash 算法<br>有没有可能 两个不相等的对象有相同的 hashcode？当两个对象 hashcode 相同怎么办？如何获取值对象<br>为什么在重写 equals 方法的时候需要重写 hashCode 方法？equals与 hashCode 的异同点在哪里<br>a.hashCode() 有什么用？与 a.equals(b) 有什么关系<br>hashCode() 和 equals() 方法的重要性体现在什么地方<br>Object：Object有哪些公用方法？Object类hashcode,equals 设计原则？ sun为什么这么设计？Object类的概述<br>如何在父类中为子类自动完成所有的 hashcode 和 equals 实现？这么做有何优劣。<br>可以在 hashcode() 中使用随机数字吗？<br>LinkedHashMap<br>JAVA架构进阶群: 678779467<br>LinkedHashMap 和 PriorityQueue 的区别是什么<br>List</p>
<p>List, Set, Map三个接口，存取元素时各有什么特点<br>List, Set, Map 是否继承自 Collection 接口<br>遍历一个 List 有哪些不同的方式<br>LinkedList<br>LinkedList 是单向链表还是双向链表<br>LinkedList 与 ArrayList 有什么区别<br>描述下 Java 中集合（Collections），接口（Interfaces），实现（Implementations）的概念。LinkedList 与 ArrayList 的区别是什么？<br>插入数据时，ArrayList, LinkedList, Vector谁速度较快？<br>ArrayList<br>ArrayList 和 HashMap 的默认大小是多数<br>ArrayList 和 LinkedList 的区别，什么时候用 ArrayList？<br>ArrayList 和 Set 的区别？<br>ArrayList, LinkedList, Vector的区别<br>ArrayList是如何实现的，ArrayList 和 LinkedList 的区别<br>ArrayList如何实现扩容<br>Array 和 ArrayList 有何区别？什么时候更适合用Array<br>说出ArraList,Vector, LinkedList的存储性能和特性<br>Map</p>
<p>Map, Set, List, Queue, Stack<br>Map 接口提供了哪些不同的集合视图<br>为什么 Map 接口不继承 Collection 接口<br>Collections</p>
<p>介绍Java中的Collection FrameWork。集合类框架的基本接口有哪些<br>Collections类是什么？Collection 和 Collections的区别？Collection、Map的实现<br>集合类框架的最佳实践有哪些<br>为什么 Collection 不从 Cloneable 和 Serializable 接口继承<br>说出几点 Java 中使用 Collections 的最佳实践？<br>Collections 中 遗留类 (HashTable、Vector) 和 现有类的区别<br>什么是 B+树，B-树，列出实际的使用场景。</p>
<p>接口</p>
<p>Comparator 与 Comparable 接口是干什么的？列出它们的区别<br>对象</p>
<p>拷贝(clone)</p>
<p>如何实现对象克隆<br>深拷贝和浅拷贝区别<br>深拷贝和浅拷贝如何实现激活机制<br>写clone()方法时，通常都有一行代码，是什么<br>比较</p>
<p>在比较对象时，”==” 运算符和 equals 运算有何区别<br>如果要重写一个对象的equals方法，还要考虑什么<br>两个对象值相同(x.equals(y) == true)，但却可有不同的hash code，这句话对不对<br>构造器</p>
<p>构造器链是什么<br>创建对象时构造器的调用顺序<br>不可变对象</p>
<p>什么是不可变象（immutable object）<br>为什么 Java 中的 String 是不可变的（Immutable）<br>如何构建不可变的类结构？关键点在哪里<br>能创建一个包含可变对象的不可变对象吗<br>如何对一组对象进行排序</p>
<p>方法</p>
<p>构造器（constructor）是否可被重写（override）<br>方法可以同时即是 static 又是 synchronized 的吗<br>abstract 的 method是否可同时是 static，是否可同时是 native，是否可同时是synchronized<br>Java支持哪种参数传递类型<br>一个对象被当作参数传递到一个方法，是值传递还是引用传递<br>当一个对象被当作参数传递到一个方法后，此方法可改变这个对象的属性，并可返回变化后的结果，那么这里到底是值传递还是引用传递<br>我们能否重载main()方法<br>如果main方法被声明为private会怎样<br>GC</p>
<p>概念</p>
<p>GC是什么？为什么要有GC<br>什么时候会导致垃圾回收<br>GC是怎么样运行的<br>新老以及永久区是什么<br>GC 有几种方式？怎么配置<br>什么时候一个对象会被GC？ 如何判断一个对象是否存活<br>System.gc() Runtime.gc()会做什么事情？ 能保证 GC 执行吗<br>垃圾回收器可以马上回收内存吗？有什么办法主动通知虚拟机进行垃圾回收？<br>Minor GC 、Major GC、Young GC 与 Full GC分别在什么时候发生<br>垃圾回收算法的实现原理<br>如果对象的引用被置为null，垃圾收集器是否会立即释放对象占用的内存？<br>垃圾回收的最佳做法是什么<br>GC收集器有哪些</p>
<p>垃圾回收器的基本原理是什么？<br>串行(serial)收集器和吞吐量(throughput)收集器的区别是什么<br>Serial 与 Parallel GC之间的不同之处<br>CMS 收集器 与 G1 收集器的特点与区别<br>CMS垃圾回收器的工作过程<br>JVM 中一次完整的 GC 流程是怎样的？ 对象如何晋升到老年代<br>吞吐量优先和响应优先的垃圾收集器选择<br>GC策略</p>
<p>举个实际的场景，选择一个GC策略<br>JVM的永久代中会发生垃圾回收吗<br>收集方法</p>
<p>标记清除、标记整理、复制算法的原理与特点？分别用在什么地方<br>如果让你优化收集方法，有什么思路<br>JVM</p>
<p>参数</p>
<p>说说你知道的几种主要的jvm 参数<br>-XX:+UseCompressedOops 有什么作用<br>类加载器(ClassLoader)</p>
<p>Java 类加载器都有哪些<br>JVM如何加载字节码文件<br>内存管理</p>
<p>JVM内存分哪几个区，每个区的作用是什么<br>一个对象从创建到销毁都是怎么在这些部分里存活和转移的<br>解释内存中的栈(stack)、堆(heap)和方法区(method area)的用法<br>JVM中哪个参数是用来控制线程的栈堆栈小<br>简述内存分配与回收策略<br>简述重排序，内存屏障，happen-before，主内存，工作内存<br>Java中存在内存泄漏问题吗？请举例说明<br>简述 Java 中软引用（SoftReferenc）、弱引用（WeakReference）和虚引用<br>内存映射缓存区是什么<br>jstack，jstat，jmap，jconsole怎么用<br>32 位 JVM 和 64 位 JVM 的最大堆内存分别是多数？32 位和 64 位的 JVM，int 类型变量的长度是多数？<br>怎样通过 Java 程序来判断 JVM 是 32 位 还是 64 位<br>JVM自身会维护缓存吗？是不是在堆中进行对象分配，操作系统的堆还是JVM自己管理堆<br>什么情况下会发生栈内存溢出<br>双亲委派模型是什么</p>
<p>多线程</p>
<p>基本概念</p>
<p>什么是线程<br>多线程的优点<br>多线程的几种实现方式<br>用 Runnable 还是 Thread<br>什么是线程安全<br>Vector, SimpleDateFormat 是线程安全类吗<br>什么 Java 原型不是线程安全的<br>哪些集合类是线程安全的<br>多线程中的忙循环是什么<br>如何创建一个线程<br>编写多线程程序有几种实现方式<br>什么是线程局部变量<br>线程和进程有什么区别？进程间如何通讯，线程间如何通讯<br>什么是多线程环境下的伪共享（false sharing）<br>同步和异步有何异同，在什么情况下分别使用他们？举例说明<br>Current</p>
<p>ConcurrentHashMap 和 Hashtable的区别<br>ArrayBlockingQueue, CountDownLatch的用法<br>ConcurrentHashMap的并发度是什么<br>CyclicBarrier 和 CountDownLatch有什么不同？各自的内部原理和用法是什么<br>Semaphore的用法<br>Thread</p>
<p>启动一个线程是调用 run() 还是 start() 方法？start() 和 run() 方法有什么区别<br>调用start()方法时会执行run()方法，为什么不能直接调用run()方法<br>sleep() 方法和对象的 wait() 方法都可以让线程暂停执行，它们有什么区别<br>yield方法有什么作用？sleep() 方法和 yield() 方法有什么区别<br>Java 中如何停止一个线程<br>stop() 和 suspend() 方法为何不推荐使用<br>如何在两个线程间共享数据<br>如何强制启动一个线程<br>如何让正在运行的线程暂停一段时间<br>什么是线程组，为什么在Java中不推荐使用<br>你是如何调用 wait（方法的）？使用 if 块还是循环？为什么<br>生命周期</p>
<p>有哪些不同的线程生命周期<br>线程状态，BLOCKED 和 WAITING 有什么区别<br>画一个线程的生命周期状态图<br>ThreadLocal 用途是什么，原理是什么，用的时候要注意什么<br>ThreadPool</p>
<p>线程池是什么？为什么要使用它<br>如何创建一个Java线程池<br>ThreadPool用法与优势<br>提交任务时，线程池队列已满时会发会生什么<br>newCache 和 newFixed 有什么区别？简述原理。构造函数的各个参数的含义是什么，比如 coreSize, maxsize 等<br>线程池的实现策略<br>线程池的关闭方式有几种，各自的区别是什么<br>线程池中submit() 和 execute()方法有什么区别？<br>线程调度</p>
<p>Java中用到的线程调度算法是什么<br>什么是多线程中的上下文切换<br>你对线程优先级的理解是什么<br>什么是线程调度器 (Thread Scheduler) 和时间分片 (Time Slicing)<br>线程同步</p>
<p>请说出你所知的线程同步的方法<br>synchronized 的原理是什么<br>synchronized 和 ReentrantLock 有什么不同<br>什么场景下可以使用 volatile 替换 synchronized<br>有T1，T2，T3三个线程，怎么确保它们按顺序执行？怎样保证T2在T1执行完后执行，T3在T2执行完后执行<br>同步块内的线程抛出异常会发生什么<br>当一个线程进入一个对象的 synchronized 方法A 之后，其它线程是否可进入此对象的 synchronized 方法B<br>使用 synchronized 修饰静态方法和非静态方法有什么区别<br>如何从给定集合那里创建一个 synchronized 的集合<br>锁</p>
<p>Java Concurrency API 中 的 Lock 接口是什么？对比同步它有什么优势<br>Lock 与 Synchronized 的区别？Lock 接口比 synchronized 块的优势是什么<br>ReadWriteLock是什么？<br>锁机制有什么用<br>什么是乐观锁（Optimistic Locking）？如何实现乐观锁？如何避免ABA问题<br>解释以下名词：重排序，自旋锁，偏向锁，轻量级锁，可重入锁，公平锁，非公平锁，乐观锁，悲观锁<br>什么时候应该使用可重入锁<br>简述锁的等级方法锁、对象锁、类锁<br>Java中活锁和死锁有什么区别？<br>什么是死锁(Deadlock)？导致线程死锁的原因？如何确保 N 个线程可以访问 N 个资源同时又不导致死锁<br>死锁与活锁的区别，死锁与饥饿的区别<br>怎么检测一个线程是否拥有锁<br>如何实现分布式锁<br>有哪些无锁数据结构，他们实现的原理是什么<br>读写锁可以用于什么应用场景<br>Executors类是什么？ Executor和Executors的区别<br>什么是Java线程转储(Thread Dump)，如何得到它<br>如何在Java中获取线程堆栈<br>说出 3 条在 Java 中使用线程的最佳实践<br>在线程中你怎么处理不可捕捉异常<br>实际项目中使用多线程举例。你在多线程环境中遇到的常见的问题是什么？你是怎么解决它的<br>请说出与线程同步以及线程调度相关的方法<br>程序中有3个 socket，需要多少个线程来处理<br>假如有一个第三方接口，有很多个线程去调用获取数据，现在规定每秒钟最多有 10 个线程同时调用它，如何做到<br>如何在 Windows 和 Linux 上查找哪个线程使用的 CPU 时间最长<br>如何确保 main() 方法所在的线程是 Java 程序最后结束的线程<br>非常多个线程（可能是不同机器），相互之间需要等待协调才能完成某种工作，问怎么设计这种协调方案<br>你需要实现一个高效的缓存，它允许多个用户读，但只允许一个用户写，以此来保持它的完整性，你会怎样去实现它</p>
<p>异常</p>
<p>基本概念</p>
<p>Error 和 Exception有什么区别<br>UnsupportedOperationException是什么<br>NullPointerException 和 ArrayIndexOutOfBoundException 之间有什么相同之处<br>什么是受检查的异常，什么是运行时异常<br>运行时异常与一般异常有何异同<br>简述一个你最常见到的runtime exception(运行时异常)<br>finally</p>
<p>finally关键词在异常处理中如何使用<br>如果执行finally代码块之前方法返回了结果，或者JVM退出了，finally块中的代码还会执行吗<br>try里有return，finally还执行么？那么紧跟在这个try后的finally {}里的code会不会被执行，什么时候被执行，在return前还是后<br>在什么情况下，finally语句不会执行<br>throw 和 throws 有什么区别？<br>OOM你遇到过哪些情况？你是怎么搞定的？<br>SOF你遇到过哪些情况？<br>既然我们可以用RuntimeException来处理错误，那么你认为为什么Java中还存在检查型异常<br>当自己创建异常类的时候应该注意什么<br>导致空指针异常的原因<br>异常处理 handle or declare 原则应该如何理解<br>怎么利用 JUnit 来测试一个方法的异常<br>catch块里别不写代码有什么问题<br>你曾经自定义实现过异常吗？怎么写的<br>什么是 异常链<br>在try块中可以抛出异常吗</p>
<p>JDBC</p>
<p>通过 JDBC 连接数据库有哪几种方式<br>阐述 JDBC 操作数据库的基本步骤<br>JDBC 中如何进行事务处理<br>什么是 JdbcTemplate<br>什么是 DAO 模块<br>使用 JDBC 操作数据库时，如何提升读取数据的性能？如何提升更新数据的性能<br>列出 5 个应该遵循的 JDBC 最佳实践<br>IO</p>
<p>File<br>File类型中定义了什么方法来创建一级目录<br>File类型中定义了什么方法来判断一个文件是否存在</p>
<p>流<br>为了提高读写性能，可以采用什么流<br>Java中有几种类型的流<br>JDK 为每种类型的流提供了一些抽象类以供继承，分别是哪些类<br>对文本文件操作用什么I/O流<br>对各种基本数据类型和String类型的读写，采用什么流<br>能指定字符编码的 I/O 流类型是什么<br>序列化<br>什么是序列化？如何实现 Java 序列化及注意事项<br>Serializable 与 Externalizable 的区别<br>Socket<br>socket 选项 TCP NO DELAY 是指什么<br>Socket 工作在 TCP/IP 协议栈是哪一层<br>TCP、UDP 区别及 Java 实现方式<br>说几点 IO 的最佳实践<br>直接缓冲区与非直接缓冲器有什么区别？<br>怎么读写 ByteBuffer？ByteBuffer 中的字节序是什么<br>当用System.in.read(buffer)从键盘输入一行n个字符后，存储在缓冲区buffer中的字节数是多少<br>如何使用扫描器类（Scanner Class）令牌化<br>面向对象编程（OOP）<br>JAVA架构进阶群: 678779467<br>解释下多态性（polymorphism），封装性（encapsulation），内聚（cohesion）以及耦合（coupling）<br>多态的实现原理<br>封装、继承和多态是什么<br>对象封装的原则是什么?<br>类<br>获得一个类的类对象有哪些方式<br>重载（Overload）和重写（Override）的区别。重载的方法能否根据返回类型进行区分？<br>说出几条 Java 中方法重载的最佳实践<br>抽象类<br>抽象类和接口的区别<br>抽象类中是否可以有静态的main方法<br>抽象类是否可实现(implements)接口<br>抽象类是否可继承具体类(concrete class)<br>匿名类（Anonymous Inner Class）<br>匿名内部类是否可以继承其它类？是否可以实现接口</p>
<p>内部类<br>内部类分为几种<br>内部类可以引用它的包含类（外部类）的成员吗<br>请说一下 Java 中为什么要引入内部类？还有匿名内部类<br>继承<br>继承（Inheritance）与聚合（Aggregation）的区别在哪里<br>继承和组合之间有什么不同<br>为什么类只能单继承，接口可以多继承<br>存在两个类，B 继承 A，C 继承 B，能将 B 转换为 C 么？如 C = (C) B<br>如果类 a 继承类 b，实现接口c，而类 b 和接口 c 中定义了同名变量，请问会出现什么问题<br>接口<br>接口是什么<br>接口是否可继承接口<br>为什么要使用接口而不是直接使用具体类？接口有什么优点<br>泛型</p>
<p>泛型的存在是用来解决什么问题<br>泛型的常用特点<br>List能否转为List<br>工具类</p>
<p>日历<br>Calendar Class的用途<br>如何在Java中获取日历类的实例<br>解释一些日历类中的重要方法<br>GregorianCalendar 类是什么<br>SimpleTimeZone 类是什么<br>Locale类是什么<br>如何格式化日期对象<br>如何添加小时(hour)到一个日期对象(Date Objects)<br>如何将字符串 YYYYMMDD 转换为日期<br>Math<br>Math.round()什么作用？Math.round(11.5) 等于多少？Math.round(-11.5)等于多少？</p>
<p>XML<br>XML文档定义有几种形式？它们之间有何本质区别？解析XML文档有哪几种方式？DOM 和 SAX 解析器有什么不同？<br>Java解析XML的方式<br>用 jdom 解析 xml 文件时如何解决中文问题？如何解析<br>你在项目中用到了 XML 技术的哪些方面？如何实现<br>动态代理</p>
<p>描述动态代理的几种实现方式，分别说出相应的优缺点<br>设计模式</p>
<p>什么是设计模式（Design Patterns）？你用过哪种设计模式？用在什么场合<br>你知道哪些商业级设计模式？<br>哪些设计模式可以增加系统的可扩展性<br>单例模式<br>除了单例模式，你在生产环境中还用过什么设计模式？<br>写 Singleton 单例模式<br>单例模式的双检锁是什么<br>如何创建线程安全的 Singleton<br>什么是类的单例模式<br>写出三种单例模式实现<br>适配器模式<br>适配器模式是什么？什么时候使用<br>适配器模式和代理模式之前有什么不同<br>适配器模式和装饰器模式有什么区别<br>什么时候使用享元模式<br>什么时候使用组合模式<br>什么时候使用访问者模式<br>什么是模板方法模式<br>请给出1个符合开闭原则的设计模式的例子<br>开放问题</p>
<p>用一句话概括 Web 编程的特点<br>Google是如何在一秒内把搜索结果返回给用户<br>哪种依赖注入方式你建议使用，构造器注入，还是 Setter方法注入<br>树（二叉或其他）形成许多普通数据结构的基础。请描述一些这样的数据结构以及何时可以使用它们<br>某一项功能如何设计<br>线上系统突然变得异常缓慢，你如何查找问题<br>什么样的项目不适合用框架<br>新浪微博是如何实现把微博推给订阅者<br>简要介绍下从浏览器输入 URL 开始到获取到请求界面之后 Java Web 应用中发生了什么<br>请你谈谈SSH整合<br>高并发下，如何做到安全的修改同一行数据<br>12306网站的订票系统如何实现，如何保证不会票不被超卖<br>网站性能优化如何优化的<br>聊了下曾经参与设计的服务器架构<br>请思考一个方案，实现分布式环境下的 countDownLatch<br>请思考一个方案，设计一个可以控制缓存总体大小的自动适应的本地缓存<br>在你的职业生涯中，算得上最困难的技术挑战是什么<br>如何写一篇设计文档，目录是什么<br>大写的O是什么？举几个例子<br>编程中自己都怎么考虑一些设计原则的，比如开闭原则，以及在工作中的应用<br>解释一下网络应用的模式及其特点<br>设计一个在线文档系统，文档可以被编辑，如何防止多人同时对同一份文档进行编辑更新<br>说出数据连接池的工作机制是什么<br>怎么获取一个文件中单词出现的最高频率<br>描述一下你最常用的编程风格<br>如果有机会重新设计你们的产品，你会怎么做<br>如何搭建一个高可用系统<br>如何启动时不需输入用户名与密码<br>如何在基于Java的Web项目中实现文件上传和下载<br>如何实现一个秒杀系统，保证只有几位用户能买到某件商品。<br>如何实现负载均衡，有哪些算法可以实现<br>如何设计一个购物车？想想淘宝的购物车如何实现的<br>如何设计一套高并发支付方案，架构如何设计<br>如何设计建立和保持 100w 的长连接<br>如何避免浏览器缓存。<br>如何防止缓存雪崩<br>如果AB两个系统互相依赖，如何解除依<br>如果有人恶意创建非法连接，怎么解决<br>如果有几十亿的白名单，每天白天需要高并发查询，晚上需要更新一次，如何设计这个功能<br>如果系统要使用超大整数（超过long长度范围），请你设计一个数据结构来存储这种超大型数字以及设计一种算法来实现超大整数加法运算）<br>如果要设计一个图形系统，请你设计基本的图形元件(Point,Line,Rectangle,Triangle)的简单实现<br>如果让你实现一个并发安全的链表，你会怎么做<br>应用服务器与WEB 服务器的区别？应用服务器怎么监控性能，各种方式的区别？你使用过的应用服务器优化技术有哪些<br>大型网站在架构上应当考虑哪些问题<br>有没有处理过线上问题？出现内存泄露，CPU利用率标高，应用无响应时如何处理的<br>最近看什么书，印象最深刻的是什么<br>描述下常用的重构技巧<br>你使用什么版本管理工具？分支（Branch）与标签（Tag）之间的区别在哪里<br>你有了解过存在哪些反模式（Anti-Patterns）吗<br>你用过的网站前端优化的技术有哪些<br>如何分析Thread dump<br>你如何理解AOP中的连接点（Joinpoint）、切点（Pointcut）、增强（Advice）、引介（Introduction）、织入（Weaving）、切面（Aspect）这些概念<br>你是如何处理内存泄露或者栈溢出问题的<br>你们线上应用的 JVM 参数有哪些<br>怎么提升系统的QPS和吞吐量<br><strong>知识面</strong></p>
<p>解释什么是 MESI 协议(缓存一致性)<br>谈谈 reactor 模型<br>Java 9 带来了怎样的新功能<br>Java 与 C++ 对比，C++ 或 Java 中的异常处理机制的简单原理和应用<br>简单讲讲 Tomcat 结构，以及其类加载器流程<br>虚拟内存是什么<br>阐述下 SOLID 原则<br>请简要讲一下你对测试驱动开发（TDD）的认识<br>CDN实现原理<br>Maven 和 ANT 有什么区别<br>UML中有哪些常用的图<br><strong>Linux</strong><br>Linux 下 IO 模型有几种，各自的含义是什么。<br>Linux 系统下你关注过哪些内核参数，说说你知道的<br>Linux 下用一行命令查看文件的最后五行<br>平时用到哪些 Linux 命令<br>用一行命令输出正在运行的 Java 进程<br>使用什么命令来确定是否有 Tomcat 实例运行在机器上<br>什么是 N+1 难题<br>什么是 paxos 算法<br>什么是 restful，讲讲你理解的 restful<br>什么是 zab 协议<br>什么是领域模型(domain model)？贫血模型(anaemic domain model) 和充血模型(rich domain model)有什么区别<br>什么是领域驱动开发（Domain Driven Development）<br>介绍一下了解的 Java 领域的 Web Service 框架<br>Web Server、Web Container 与 Application Server 的区别是什么<br>微服务（MicroServices）与巨石型应用（Monolithic Applications）之间的区别在哪里<br>描述 Cookie 和 Session 的作用，区别和各自的应用范围，Session工作原理<br>你常用的持续集成（Continuous Integration）、静态代码分析（Static Code Analysis）工具有哪些<br>简述下数据库正则化（Normalizations）<br>KISS,DRY,YAGNI 等原则是什么含义<br>分布式事务的原理，优缺点，如何使用分布式事务？<br>布式集群下如何做到唯一序列号<br><strong>网络</strong><br>HTTPS 的加密方式是什么，讲讲整个加密解密流程<br>HTTPS和HTTP的区别<br>HTTP连接池实现原理<br>HTTP集群方案<br>Nginx、lighttpd、Apache三大主流 Web服务器的区别<br>是否看过框架的一些代码<br>持久层设计要考虑的问题有哪些？你用过的持久层框架有哪些<br>数值提升是什么<br>你能解释一下里氏替换原则吗<br>你是如何测试一个应用的？知道哪些测试框架<br>传输层常见编程协议有哪些？并说出各自的特点<br><strong>编程题</strong></p>
<p><strong>计算加班费</strong></p>
<p>加班10小时以下加班费是时薪的1.5倍。加班10小时或以上，按4元/时算。提示：（一个月工作26天，一天正常工作8小时）</p>
<p>计算1000月薪，加班9小时的加班费<br>计算2500月薪，加班11小时的加班费<br>计算1000月薪，加班15小时的加班费<br>卖东西</p>
<p>一家商场有红苹果和青苹果出售。（红苹果5元/个，青苹果4元/个）。</p>
<p>模拟一个进货。红苹果跟青苹果各进200个。<br>模拟一个出售。红苹果跟青苹果各买出10个。每卖出一个苹果需要进行统计。<br>提示：一个苹果是一个单独的实体。</p>
<p><strong>日期提取</strong></p>
<p>有这样一个时间字符串：2008-8-8 20:08:08 ， 请编写能够匹配它的正则表达式，并编写Java代码将日期后面的时分秒提取出来，即：20:08:08</p>
<p><strong>线程</strong></p>
<p>8设计4个线程，其中两个线程每次对j增加1，另外两个线程对j每次减少1。写出程序。<br>用Java写一个多线程程序，如写四个线程，二个加1，二个对一个变量减一，输出<br>wait-notify 写一段代码来解决生产者-消费者问题<br>数字</p>
<p>判断101-200之间有多少个素数，并输出所有素数<br>用最有效率的方法算出2乘以17等于多少<br>有 1 亿个数字，其中有 2 个是重复的，快速找到它，时间和空间要最优<br>2 亿个随机生成的无序整数,找出中间大小的值<br>10 亿个数字里里面找最小的 10 个<br>1到1亿的自然数，求所有数的拆分后的数字之和，如286 拆分成2、8、6，如1到11拆分后的数字之和 =&gt; 1 + … + 9 + 1 + 0 + 1 + 1<br>一个数如果恰好等于它的因子之和，这个数就称为 “完数 “。例如6=1＋2＋3.编程 找出1000以内的所有完数<br>一个数组中所有的元素都出现了三次，只有一个元素出现了一次找到这个元素<br>一球从100米高度自由落下，每次落地后反跳回原高度的一半；再落下，求它在 第10次落地时，共经过多少米？第10次反弹多高？<br>求100－1000内质数的和<br>求1到100的和的平均数<br>求s=a+a+aaa+aaaa+aa…a的值，其中a是一个数字。例如2+22+222+2222+22222(此时共有5个数相加)，几个数相加有键盘控制。 求出1到100的和<br>算出1到40的质数，放进数组里<br>显示放组里的数<br>找出第[5]个数<br>删除第[9]个数，再显示删除后的第[9]个<br>有 3n+1 个数字，其中 3n 个中是重复的，只有 1 个是不重复的，怎么找出来。<br>有一组数1.1.2.3.5.8.13.21.34。写出程序随便输入一个数就能给出和前一组数字同规律的头5个数<br>计算指定数字的阶乘<br>开发 Fizz Buzz<br>给定一个包含 N 个整数的数组，找出丢失的整数<br>一个排好序的数组，找出两数之和为m的所有组合<br>将一个正整数分解质因数。例如：输入90,打印出90=2<em>3</em>3*5。<br>打印出所有的 “水仙花数 “，所谓 “水仙花数 “是指一个三位数，其各位数字立方和等于该数本身。例如：153是一个 “水仙花数 “，因为153=1的三次方＋5的三次方＋3的三次方<br>原地交换两个变量的值<br>找出4字节整数的中位数<br>找到整数的平方根<br>实现斐波那契<br>网络</p>
<p>用Java Socket编程，读服务器几个字符，再写入本地显示<br><strong>反射</strong></p>
<p>反射机制提供了什么功能？<br>反射是如何实现的<br>哪里用到反射机制<br>反射中 Class.forName 和 ClassLoader 区别<br>反射创建类实例的三种方式是什么<br>如何通过反射调用对象的方法<br>如何通过反射获取和设置对象私有字段的值<br>反射机制的优缺点</p>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a><strong>数据库</strong></h2><p>JAVA架构进阶群: 678779467<br>写一段 JDBC 连Oracle的程序,并实现数据查询<br>算法</p>
<p>50个人围坐一圈，当数到三或者三的倍数出圈，问剩下的人是谁，原来的位置是多少<br>实现一个电梯模拟器用<br>写一个冒泡排序<br>写一个折半查找<br>随机产生20个不能重复的字符并排序<br>写一个函数，传入 2 个有序的整数数组，返回一个有序的整数数组<br>写一段代码在遍历 ArrayList 时移除一个元素<br>古典问题：有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第四个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少<br>约瑟芬环游戏<br>正则</p>
<p>请编写一段匹配IP地址的正则表达式<br>写出一个正则表达式来判断一个字符串是否是一个数字<br>字符串</p>
<p>写一个方法，入一个文件名和一个字符串，统计这个字符串在这个文件中出现的次数。<br>写一个程序找出所有字符串的组合，并检查它们是否是回文串<br>写一个字符串反转函数，输入abcde转换成edcba代码<br>小游戏，倒转句子中的单词<br>将GB2312编码的字符串转换为ISO-8859-1编码的字符串<br>请写一段代码来计算给定文本内字符“A”的个数。分别用迭代和递归两种方式<br>编写一个截取字符串的函数，输入为一个字符串和字节数，输出为按字节截取的字符串。 但是要保证汉字不被截半个，如“我ABC”4，应该截为“我AB”，输入“我ABC汉DEF”，6，应该输出为“我ABC”而不是“我ABC+汉的半个”<br>给定 2 个包含单词列表（每行一个）的文件，编程列出交集<br>打印出一个字符串的所有排列<br>将一个键盘输入的数字转化成中文输出(例如：输入1234567，输出:一百二拾三万四千五百六拾七)<br>在Web应用开发过程中经常遇到输出某种编码的字符，如从 GBK 到 ISO8859-1等，如何输出一个某种编码的字符串<br>日期</p>
<p>计算两个日期之间的差距</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/13/图解设计模式-第十章-Strategy模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/13/图解设计模式-第十章-Strategy模式/" itemprop="url">
                  图解设计模式-第十章-Strategy模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-13T20:58:33+08:00">
                2017-11-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>无论什么程序, 其目的都是解决问题, 为了解决问题, 需要编写特定的算法. 使用Strategy模式可以整体地替换算法的实现部分. </p>
<p>能整体地替换算法, 以不同的算法解决同一个问题, 这种模式就是Strategy模式.</p>
<p><strong>Strategy模式类图</strong></p>
<img src="/2017/11/13/图解设计模式-第十章-Strategy模式/Strategy-Main.png" alt="Strategy-Main" title="Strategy-Main">
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是让电脑玩”猜拳”游戏.</p>
<p>第一种策略是: 如果这局猜拳获胜, 纳闷下一局也出一样的手势.</p>
<p>第二种策略是: 根据上一局的手势从概率上计算出下一局的手势.</p>
<h4 id="类和接口一览表"><a href="#类和接口一览表" class="headerlink" title="类和接口一览表"></a>类和接口一览表</h4><table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hand</td>
<td>表示猜拳游戏中的”手势”的类</td>
</tr>
<tr>
<td>Strategy</td>
<td>表示猜拳游戏中的策略的类</td>
</tr>
<tr>
<td>WinningStrategy</td>
<td>表示第一种策略的类</td>
</tr>
<tr>
<td>ProbStrategy</td>
<td>表示第二种策略的类</td>
</tr>
<tr>
<td>Player</td>
<td>表示进行猜拳游戏的选手的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试类</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><img src="/2017/11/13/图解设计模式-第十章-Strategy模式/Strategy-Simple.png" alt="Strategy-Simple" title="Strategy-Simple">
<h4 id="Hand类"><a href="#Hand类" class="headerlink" title="Hand类"></a>Hand类</h4><p>用int表示所出的手势: 0表示石头, 1表示剪刀, 2表示布, 并将值保存在handValue字段中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">this</span>.handValue+!)%<span class="number">3</span> == h.handValue</div></pre></td></tr></table></figure>
<p>这个表达式表示: 如果this的手势值加上1后是h的手势值(例如: 如果this的手势是石头, 而h是剪刀, 或是this的手势是剪刀, 而h的是布, 或者this的手势是布, 而h的手势是石头), 那么判断this获胜.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hand</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_GUU = <span class="number">0</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_CHO = <span class="number">1</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_PAA = <span class="number">2</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Hand[] hand = &#123;</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_GUU),</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_CHO),</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_PAA)</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] name = &#123;</div><div class="line">            <span class="string">"石头"</span>, <span class="string">"剪刀"</span>, <span class="string">"布"</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> handValue;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Hand</span><span class="params">(<span class="keyword">int</span> handValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.handValue = handValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Hand <span class="title">getHand</span><span class="params">(<span class="keyword">int</span> handValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> hand[handValue];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isStrongerThen</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fight(h) == <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isWeakerThen</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fight(h) == -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">fight</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == h) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">this</span>.handValue + <span class="number">1</span>)%<span class="number">3</span> == h.handValue) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name[handValue];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Stategy接口"><a href="#Stategy接口" class="headerlink" title="Stategy接口"></a>Stategy接口</h4><p>定义了猜拳策略的抽象方法的接口. </p>
<p>study方法的作用是学习”上一局的手势是否获胜了”. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="function">Hand <span class="title">nextHand</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="WinningStrategy类"><a href="#WinningStrategy类" class="headerlink" title="WinningStrategy类"></a>WinningStrategy类</h4><p>这个类的策略是: 如果上一局的手势获胜了, 则下一局的手势就与上一局相同. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WinningStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Random random;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> won = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">private</span> Hand prevHand;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WinningStrategy</span><span class="params">(<span class="keyword">int</span> seed)</span> </span>&#123;</div><div class="line">        random = <span class="keyword">new</span> Random(seed);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!won)</div><div class="line">            prevHand = Hand.getHand(random.nextInt(<span class="number">3</span>));</div><div class="line">        <span class="keyword">return</span> prevHand;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span> </span>&#123;</div><div class="line">        won = win;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ProbStrategy类"><a href="#ProbStrategy类" class="headerlink" title="ProbStrategy类"></a>ProbStrategy类</h4><p>这个类的策略是: 每种手势出现的概率会根据以前的猜拳结果二改变. </p>
<p>history字段是一个表, 用来根据过去的胜负来进行概率计算. 它是一个二维数组, 每个数组下标的意思如下:</p>
<p><code>history[上一句出的手势][这一局出的手势]</code></p>
<p>这个表达式的值越大, 表示过去的胜率越高. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProbStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Random random;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> prevHandValue = <span class="number">0</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> currentHandValue = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[][] history = &#123;</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">    &#125;;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProbStrategy</span><span class="params">(<span class="keyword">int</span> seed)</span> </span>&#123;</div><div class="line">        random = <span class="keyword">new</span> Random(seed);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> bet = random.nextInt(getSum(currentHandValue));</div><div class="line">        <span class="keyword">int</span> handValue = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (bet &lt; history[currentHandValue][<span class="number">0</span>]) &#123;</div><div class="line">            handValue = <span class="number">0</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bet &lt; history[currentHandValue][<span class="number">0</span>] + history[currentHandValue][<span class="number">1</span>]) &#123;</div><div class="line">            handValue = <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            handValue = <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        prevHandValue = currentHandValue;</div><div class="line">        currentHandValue = handValue;</div><div class="line">        <span class="keyword">return</span> Hand.getHand(handValue);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getSum</span><span class="params">(<span class="keyword">int</span> currentHandValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; i++) &#123;</div><div class="line">            sum += history[currentHandValue][i];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (win) &#123;</div><div class="line">            history[prevHandValue][currentHandValue]++;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            history[prevHandValue][(currentHandValue+<span class="number">1</span>)%<span class="number">3</span>]++;</div><div class="line">            history[prevHandValue][(currentHandValue+<span class="number">2</span>)%<span class="number">3</span>]++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Player类"><a href="#Player类" class="headerlink" title="Player类"></a>Player类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> Strategy strategy;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> winCount;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> loseCount;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> gameCount;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Player</span><span class="params">(String name, Strategy strategy)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.strategy = strategy;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> strategy.nextHand();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">win</span><span class="params">()</span> </span>&#123;</div><div class="line">        strategy.study(<span class="keyword">true</span>);</div><div class="line">        winCount++;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lose</span><span class="params">()</span> </span>&#123;</div><div class="line">        strategy.study(<span class="keyword">false</span>);</div><div class="line">        loseCount++;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">even</span><span class="params">()</span> </span>&#123;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"["</span> + name + <span class="string">":"</span> + gameCount + <span class="string">" games, "</span> + winCount + <span class="string">" win, "</span> + loseCount + <span class="string">" lose]"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> seed1 = Integer.parseInt(<span class="string">"314"</span>);</div><div class="line">        <span class="keyword">int</span> seed2 = Integer.parseInt(<span class="string">"15"</span>);</div><div class="line"></div><div class="line">        Player player1 = <span class="keyword">new</span> Player(<span class="string">"Taro"</span>, <span class="keyword">new</span> WinningStrategy(seed1));</div><div class="line">        Player player2 = <span class="keyword">new</span> Player(<span class="string">"Hana"</span>, <span class="keyword">new</span> ProbStrategy(seed2));</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000</span>; i++) &#123;</div><div class="line">            Hand nextHand1 = player1.nextHand();</div><div class="line">            Hand nextHand2 = player2.nextHand();</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (nextHand1.isStrongerThen(nextHand2)) &#123;</div><div class="line">                System.out.println(<span class="string">"Winner: "</span> + player1);</div><div class="line">                player1.win();</div><div class="line">                player2.lose();</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nextHand2.isStrongerThen(nextHand1)) &#123;</div><div class="line">                System.out.println(<span class="string">"Winner:"</span> + player2);</div><div class="line">                player1.lose();</div><div class="line">                player2.win();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                System.out.println(<span class="string">"Even...."</span>);</div><div class="line">                player1.even();</div><div class="line">                player2.even();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"Total result: "</span>);</div><div class="line">        System.out.println(player1.toString());</div><div class="line">        System.out.println(player2.toString());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Strategy模式中的角色"><a href="#Strategy模式中的角色" class="headerlink" title="Strategy模式中的角色"></a>Strategy模式中的角色</h3><ul>
<li><p>Strategy(策略)</p>
<p>负责决定实现策略所必需的接口</p>
</li>
<li><p>ConcreteStrategy</p>
<p>负责实现Strategy角色的接口, 即负责实现具体的策略.</p>
</li>
<li><p>Context(上下文)</p>
<p>负责使用Strategy角色</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/09/图解设计模式-第九章-Bridge模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/09/图解设计模式-第九章-Bridge模式/" itemprop="url">
                  图解设计模式-第九章-Bridge模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-09T20:18:49+08:00">
                2017-11-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Bridge模式的作用是将两样东西连接起来, 它们分别是<strong>类的功能层次结构</strong>和<strong>类的实现层次结构</strong>.</p>
<p>类的层次结构的作用:</p>
<ul>
<li><p>希望增加新功能时</p>
<p>父类具有极本功能, 在子类中增加新的功能. 这就是”类的功能层次结构”</p>
</li>
<li><p>希望增加新的实现是</p>
<p>父类通过声明抽象方法来定义接口, 子类通过实现具体方法来实现接口. 这就是”类的实现层次结构”.</p>
</li>
<li><p>类层次结构的混杂与分离</p>
<p>当类的层次结构只有一层时, 功能层次结构与实现层次结构混杂在一个层次结构中. 这样容易使类的层次结构变得复杂, 也难以透彻理解类的层次结构.  因此需要将”类的功能层次结构”和”类的实现层次结构”分离为两个独立的类层次结构. </p>
</li>
</ul>
<p>Bridge模式类图:</p>
<img src="/2017/11/09/图解设计模式-第九章-Bridge模式/Bridge-Main.png" alt="Bridge-Main" title="Bridge-Main">
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>功能是 显示一些东西.</p>
<p>类的一览表:</p>
<table>
<thead>
<tr>
<th>在哪个层次结构</th>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>类的功能层次结构</td>
<td>Display</td>
<td>负责显示的类</td>
</tr>
<tr>
<td>类的功能层次结构</td>
<td>CountDisplay</td>
<td>增加了只显示规定次数功能的类</td>
</tr>
<tr>
<td>类的实现层次结构</td>
<td>DisplayImpl</td>
<td>负责显示的类</td>
</tr>
<tr>
<td>类的实现层次结构</td>
<td>StringDisplayImpl</td>
<td>用字符串显示的类</td>
</tr>
<tr>
<td></td>
<td>Main</td>
<td>测试程序</td>
</tr>
</tbody>
</table>
<p>实例程序类图:</p>
<img src="/2017/11/09/图解设计模式-第九章-Bridge模式/Bridge-Simple.png" alt="Bridge-Simple" title="Bridge-Simple">
<h4 id="Display类"><a href="#Display类" class="headerlink" title="Display类"></a>Display类</h4><p>负责显示一些东西的类. impl字段中保存的是实现Display类的具体功能的实例. impl字段即是类的两个层次结构的”桥梁”.</p>
<p>open是显示前的处理</p>
<p>print是显示处理</p>
<p>close是显示后的处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Display</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> DisplayImpl impl;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Display</span><span class="params">(DisplayImpl impl)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.impl = impl;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawOpen();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawPrint();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawClose();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> finla <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    print();</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="CountDisplay类"><a href="#CountDisplay类" class="headerlink" title="CountDisplay类"></a>CountDisplay类</h4><p>CountDisplay类在Display类的基础上增加了一个新的功能, 具有显示规定次数的功能.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountDisplay</span> <span class="keyword">extends</span> <span class="title">Display</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CountDisplay</span><span class="params">(DisplayImpl impl)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(impl);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">multiDisplay</span><span class="params">(<span class="keyword">int</span> times)</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;times; i++) &#123;</div><div class="line">      print();</div><div class="line">    &#125;</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="DisplayImpl类"><a href="#DisplayImpl类" class="headerlink" title="DisplayImpl类"></a>DisplayImpl类</h4><p>DisplayImpl类是抽象类, 声明了rawOpen, rawPrint, rawClose方法分别和Display类的open, print, close方法对应.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">DisplayImpl</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawOpen</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawPrint</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawClose</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="StringDisplay类"><a href="#StringDisplay类" class="headerlink" title="StringDisplay类"></a>StringDisplay类</h4><p>显示字符串的类. 继承DisplayImpl类, 作为其子类, 使用rawOpen, rawPrint. rawClose方法进行显示.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringDisplayImpl</span> <span class="keyword">extends</span> <span class="title">DisplayImpl</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> String string;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> width;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StringDisplayImpl</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.string = string;</div><div class="line">    <span class="keyword">this</span>.width = string.getBytes().length;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rawOpen</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"|"</span> + string + <span class="string">"|"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printLine</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"+"</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;width; i++) &#123;</div><div class="line">      System.out.println(<span class="string">"-"</span>);</div><div class="line">    &#125;</div><div class="line">    System.out.println(<span class="string">"+"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>DisplayImpl和StringDisplayImpl类相当于类的实现层次结构</p>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Display d1 = <span class="keyword">new</span> Display(<span class="keyword">new</span> StringDisplayImpl(<span class="string">"hello, world!"</span>));</div><div class="line">    CountDisplay c1 = <span class="keyword">new</span> countDisplay(<span class="keyword">new</span> StringDisplayImpl(<span class="string">"Hello, World."</span>));</div><div class="line">    </div><div class="line">    d1.display();</div><div class="line">    c1.display();</div><div class="line">    c1.multiDisplay(<span class="number">5</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Bridge模式中的角色"><a href="#Bridge模式中的角色" class="headerlink" title="Bridge模式中的角色"></a>Bridge模式中的角色</h3><ul>
<li><p>Abstraction(抽象化)</p>
<p>位于类的功能层次结构,  使用Implementor角色的方法定义了基本功能. 保存了Implementor角色的实例.</p>
</li>
<li><p>RefinedAbstraction(改善后的抽象化)</p>
<p>在Abstraction角色的基础上增加新的功能. </p>
</li>
<li><p>Implementor(实现者)</p>
<p>位于类的实现层次结构, 定义了用于实现Abstraction角色的接口方法. </p>
</li>
<li><p>ConcreteImplementor(具体的实现者)</p>
<p>负责实现implementor角色中定义的接口.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/08/图解设计模式-第八章-AbstractFactory模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/08/图解设计模式-第八章-AbstractFactory模式/" itemprop="url">
                  图解设计模式-第八章-AbstractFactory模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-08T20:23:35+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>抽象工厂模式并不关心零件的具体实现, 而是只关心接口. 仅适用改接口将零件组装成产品.</p>
<p>抽象工厂模式类图:</p>
<img src="/2017/11/08/图解设计模式-第八章-AbstractFactory模式/AbstractFactory-Main.png" alt="AbstractFactory-Main" title="AbstractFactory-Main">
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是将带有层次关系的链接的集合制作成HTML文件. </p>
<h4 id="类的一览表"><a href="#类的一览表" class="headerlink" title="类的一览表"></a>类的一览表</h4><table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Factory</td>
<td>表示抽象工厂类</td>
</tr>
<tr>
<td>Item</td>
<td>方便统一处理Link和Tray的类</td>
</tr>
<tr>
<td>Link</td>
<td>抽象零件: 表示HTML的链接的类</td>
</tr>
<tr>
<td>Tray</td>
<td>抽象零件: 表示含有Link和Tray的类</td>
</tr>
<tr>
<td>Page</td>
<td>抽象零件: 表示HTML页面的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序</td>
</tr>
<tr>
<td>ListFactory</td>
<td>表示具体的工厂的类</td>
</tr>
<tr>
<td>ListLink</td>
<td>具体零件: 表示HTML的链接的类</td>
</tr>
<tr>
<td>ListTray</td>
<td>具体领奖: 表示含有Link和Tray的类</td>
</tr>
<tr>
<td>ListPage</td>
<td>具体零件: 表示HTML页面的类</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><img src="/2017/11/08/图解设计模式-第八章-AbstractFactory模式/AbstractFactory-Simple.png" alt="AbstractFactory-Simple" title="AbstractFactory-Simple">
<h4 id="Item类"><a href="#Item类" class="headerlink" title="Item类"></a>Item类</h4><p>Link类和Tray类的父类. 使得Link类和Tray类具有可替换性. caption字段表示项目的标题. </p>
<p>makeHTML方法是抽象方法, 需要子类实现这个方法. 返回HTML文件的内容.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String caption;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Item</span><span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.caption = caption;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">makeHTML</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Link类"><a href="#Link类" class="headerlink" title="Link类"></a>Link类</h4><p>是抽象地表示HTML的超链接的类. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String url;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Link</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">        <span class="keyword">this</span>.url = url;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Tray类"><a href="#Tray类" class="headerlink" title="Tray类"></a>Tray类</h4><p>表示一个含有多个Link类和Tray类的容器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Tray</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> ArrayList tray = <span class="keyword">new</span> ArrayList();</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tray</span> <span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span> </span>&#123;</div><div class="line">        tray.add(item);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Page类"><a href="#Page类" class="headerlink" title="Page类"></a>Page类</h4><p>抽象的表示HTML页面的类. 如果把Link和Tray比喻成抽象的零件, 那Page类就是抽象的产品. </p>
<p>output方法是一个简单的Template Method模式的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Page</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String title;</div><div class="line">    <span class="keyword">protected</span> String author;</div><div class="line">    <span class="keyword">protected</span> ArrayList content = <span class="keyword">new</span> ArrayList();</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Page</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.title = title;</div><div class="line">        <span class="keyword">this</span>.author = author;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span> </span>&#123;</div><div class="line">        content.add(item);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            String fileName = title + <span class="string">".html"</span>;</div><div class="line">            Writer writer = <span class="keyword">new</span> FileWriter(fileName);</div><div class="line">            writer.write(<span class="keyword">this</span>.makeHTML());</div><div class="line">            writer.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">makeHTML</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Factory类"><a href="#Factory类" class="headerlink" title="Factory类"></a>Factory类</h4><p>getFactory方法可以根据类名生成具体的工厂实例. className指定为具体工厂对应的字符串.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Factory <span class="title">getFactory</span><span class="params">(String className)</span> </span>&#123;</div><div class="line">        Factory factory = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            factory = (Factory) Class.forName(className).newInstance();</div><div class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> factory;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Link <span class="title">createLink</span><span class="params">(String caption, String url)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Tray <span class="title">createTray</span><span class="params">(String caption)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Page <span class="title">createPage</span><span class="params">(String title, String author)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</div><div class="line">            System.out.println(<span class="string">"Usage: java Main class.name.of.ConcreteFactory"</span>);</div><div class="line">            System.out.println(<span class="string">"Example 1: java Main listfactory.ListFactyr"</span>);</div><div class="line">            System.out.println(<span class="string">"Example 2: java Main tablefactory.TableFactory"</span>);</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Factory factory = Factory.getFactory(args[<span class="number">0</span>]);</div><div class="line"></div><div class="line">        Link people = factory.createLink(<span class="string">"PeoPle: "</span>, <span class="string">"http://www.people.com.cn"</span>);</div><div class="line">        Link us_yahoo = factory.createLink(<span class="string">"Yahoo!: "</span>, <span class="string">"http://www.yahoo.com"</span>);</div><div class="line"></div><div class="line">        Tray trayNews = factory.createTray(<span class="string">"Links"</span>);</div><div class="line">        trayNews.add(people);</div><div class="line">        trayNews.add(us_yahoo);</div><div class="line"></div><div class="line">        Page page = factory.createPage(<span class="string">"LinkPage"</span>, <span class="string">"Blue"</span>);</div><div class="line">        page.add(trayNews);</div><div class="line">        page.output();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListFactory类"><a href="#ListFactory类" class="headerlink" title="ListFactory类"></a>ListFactory类</h4><p>具体的工程类. 实现Factory类的抽象方法. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Link <span class="title">createLink</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListLink(caption, url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Tray <span class="title">createTray</span><span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListTray(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Page <span class="title">createPage</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListPage(title, author);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListLink类"><a href="#ListLink类" class="headerlink" title="ListLink类"></a>ListLink类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListLink</span> <span class="keyword">extends</span> <span class="title">Link</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListLink</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption, url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"&lt;li&gt;&lt;a href=\""</span> + url + <span class="string">"\"&gt;"</span> + caption + <span class="string">"&lt;/a&gt;&lt;/li&gt;\n"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListTray类"><a href="#ListTray类" class="headerlink" title="ListTray类"></a>ListTray类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListTray</span> <span class="keyword">extends</span> <span class="title">Tray</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListTray</span> <span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">        buffer.append(<span class="string">"&lt;li&gt;\n"</span>);</div><div class="line">        buffer.append(caption + <span class="string">"\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;ul&gt;\n"</span>);</div><div class="line">        Iterator it = tray.iterator();</div><div class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">            Item item = (Item) it.next();</div><div class="line">            buffer.append(item.makeHTML());</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"&lt;/ul&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;/li&gt;\n"</span>);</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListPage类"><a href="#ListPage类" class="headerlink" title="ListPage类"></a>ListPage类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListPage</span> <span class="keyword">extends</span> <span class="title">Page</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListPage</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(title, author);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">        buffer.append(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + title + <span class="string">"&lt;/title&gt;&lt;/head&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;body&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;h1&gt;"</span> + title + <span class="string">"&lt;/h1&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;ul&gt;\n"</span>);</div><div class="line">        Iterator it = content.iterator();</div><div class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">            Item item = (Item) it.next();</div><div class="line">            buffer.append(item.makeHTML());</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"&lt;/ul&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;hr&gt;&lt;address&gt;"</span> + author + <span class="string">"&lt;/address&gt;"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;/body&gt;&lt;/btml&gt;\n"</span>);</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Abstray-Factory模式中的角色"><a href="#Abstray-Factory模式中的角色" class="headerlink" title="Abstray Factory模式中的角色"></a>Abstray Factory模式中的角色</h3><ul>
<li><p>AbstractProduct(抽象产品)</p>
<p>负责定义AbstractFactory角色所生成的抽象零件盒产品的接口.</p>
</li>
<li><p>AbstractFactory(抽象工厂)</p>
<p>负责定义用于生成抽象产品的接口</p>
</li>
<li><p>Client(委托者)</p>
<p>仅会调用AbstractFactory角色和AbstractProduct角色的接口进行工作.</p>
</li>
<li><p>ConcreteProduct(具体产品)</p>
<p>负责实现AbstractProduct角色的接口.</p>
</li>
<li><p>ConcreteFactory(具体工厂)</p>
<p>负责实现AbstractFactory角色的接口</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/07/图解设计模式-第七章-Builder模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/07/图解设计模式-第七章-Builder模式/" itemprop="url">
                  图解设计模式-第七章-Builder模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-07T20:28:40+08:00">
                2017-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Builder模式用于组装具有复杂结构的实例.</p>
<p>Builder模式类图:</p>
<img src="/2017/11/07/图解设计模式-第七章-Builder模式/Builder-Main.png" alt="Builder-Main" title="Builder-Main">
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是使用Builder模式编写”文档”. 文档具有以下结构:</p>
<ul>
<li>含有一个标题</li>
<li>含有几个字符串</li>
<li>含有条目项目</li>
</ul>
<p>Builder类中定义了决定文档结构的方法, Director类使用改方法编写一个具体的文档. </p>
<p>Builder是抽象类, 它并没有进行任何实际的处理. 仅仅声明了抽象方法. </p>
<p>TextBuilder类使用纯文本编写文档</p>
<p>HTMLBuilder类使用HTML编写文档</p>
<p>类的一览表:</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Builder</td>
<td>定义了决定文档结构的方法的抽象类</td>
</tr>
<tr>
<td>Director</td>
<td>编写一个文档的类</td>
</tr>
<tr>
<td>TextBuilder</td>
<td>使用纯文本编写文档的类</td>
</tr>
<tr>
<td>HTMLBuilder</td>
<td>使用HTML编写文档的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><img src="/2017/11/07/图解设计模式-第七章-Builder模式/Builder-Simple.png" alt="Builder-Simple" title="Builder-Simple">
<h4 id="Builder类"><a href="#Builder类" class="headerlink" title="Builder类"></a>Builder类</h4><p>makeTitle, makeString. makeItems方法分别是编写标题, 字符串, 条目的方法. close方法是完成文档的编写.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Director类"><a href="#Director类" class="headerlink" title="Director类"></a>Director类</h4><p>Director类使用Builder类中声明的方法来编写文档.</p>
<p>Director类的构造函数的参数是Builder类型. </p>
<p>construct方法是编写文档的方法. 调用这个方法后就会编写文档. construct方法中所使用的方法都试在Builder类中声明的方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Builder builder;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.builder = builder;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        builder.makeTitle(<span class="string">"Greeting"</span>);</div><div class="line">        builder.makeString(<span class="string">"从早上到下午 "</span>);</div><div class="line">        builder.makeItems(<span class="keyword">new</span> String[] &#123;</div><div class="line">                <span class="string">"早上好"</span>,</div><div class="line">                <span class="string">"下午好"</span></div><div class="line">        &#125;);</div><div class="line">        builder.makeString(<span class="string">"晚上"</span>);</div><div class="line">        builder.makeItems(<span class="keyword">new</span> String[] &#123;</div><div class="line">                <span class="string">"晚上好"</span>,</div><div class="line">                <span class="string">"晚安"</span>,</div><div class="line">                <span class="string">"再见"</span></div><div class="line">        &#125;);</div><div class="line">        builder.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="TextBuilder类"><a href="#TextBuilder类" class="headerlink" title="TextBuilder类"></a>TextBuilder类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">"==============================\n"</span>);</div><div class="line">        buffer.append(<span class="string">"["</span> + title +<span class="string">"]\n"</span>);</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">'*'</span> + str + <span class="string">"\n"</span>);</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (String item : items) &#123;</div><div class="line">            buffer.append(<span class="string">" ."</span> + item + <span class="string">"\n"</span>);</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">"==============================\n"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getResult</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="HTMLBuilder类"><a href="#HTMLBuilder类" class="headerlink" title="HTMLBuilder类"></a>HTMLBuilder类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTMLBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String fileName;</div><div class="line">    <span class="keyword">private</span> PrintWriter writer;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span> </span>&#123;</div><div class="line">        fileName = title + <span class="string">".html"</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            writer = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> FileWriter(fileName));</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        writer.println(<span class="string">"&lt;html&gt;"</span> +</div><div class="line">                <span class="string">"&lt;head&gt;&lt;title&gt;"</span>+title+<span class="string">"&lt;/title&gt;&lt;/head&gt;"</span> +</div><div class="line">                <span class="string">"&lt;body&gt;"</span> +</div><div class="line">                <span class="string">"&lt;h1&gt;"</span>+title+<span class="string">"&lt;/h1&gt;"</span></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;p&gt;"</span> + str + <span class="string">"&lt;/p&gt;"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;ul&gt;"</span>);</div><div class="line">        <span class="keyword">for</span> (String item : items) &#123;</div><div class="line">            writer.println(<span class="string">"&lt;li&gt;"</span>+item+<span class="string">"&lt;/li&gt;"</span>);</div><div class="line">        &#125;</div><div class="line">        writer.println(<span class="string">"&lt;/ul&gt;"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</div><div class="line">        writer.close();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getResult</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fileName;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</div><div class="line">            usage();</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">"plain"</span>)) &#123;</div><div class="line">            TextBuilder textBuilder = <span class="keyword">new</span> TextBuilder();</div><div class="line">            Director director = <span class="keyword">new</span> Director(textBuilder);</div><div class="line">            director.construct();</div><div class="line">            String result = textBuilder.getResult();</div><div class="line">            System.out.println(result);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">"html"</span>)) &#123;</div><div class="line">            HTMLBuilder htmlBuilder = <span class="keyword">new</span> HTMLBuilder();</div><div class="line">            Director director = <span class="keyword">new</span> Director(htmlBuilder);</div><div class="line">            director.construct();</div><div class="line">            String fileName = htmlBuilder.getResult();</div><div class="line">            System.out.println(fileName + <span class="string">"文件编写完成"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            usage();</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">usage</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Usage: java Main plain  编写纯文本文档"</span>);</div><div class="line">        System.out.println(<span class="string">"Usage: java Main html  编写HTML文档"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Builder模式中的角色"><a href="#Builder模式中的角色" class="headerlink" title="Builder模式中的角色"></a>Builder模式中的角色</h3><ul>
<li><p>Builder(建造者)</p>
<p>负责定义生成实例的接口. 准备了用于生成实例的方法.</p>
</li>
<li><p>ConcreteBuilder(具体的建造者)</p>
<p>负责实现Builder的接口. </p>
</li>
<li><p>Director(监工)</p>
<p>负责使用Builder角色的接口. 不依赖于具体的建造者(ConcreteBuilder). 只调用在Builder角色中定义的方法.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/06/图解设计模式-第六章-Prototype模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/06/图解设计模式-第六章-Prototype模式/" itemprop="url">
                  图解设计模式-第六章-Prototype模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-06T20:00:48+08:00">
                2017-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>根据实例原型, 实例模型来生成新的实例, 这就是Prototype模式.</p>
<p>Java可以使用clone创建实例的副本. </p>
<p>Prototype模式类图:</p>
<img src="/2017/11/06/图解设计模式-第六章-Prototype模式/Prototype-Main.png" alt="Prototype-Main" title="Prototype-Main">
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是将字符串放入方框中下石出来或者加上下划线显示出来. </p>
<p>类和接口一览表</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Product</td>
<td>声明了抽象方法use和createClone的接口</td>
</tr>
<tr>
<td>Manager</td>
<td>调用createClone方法复制实例的类</td>
</tr>
<tr>
<td>MessageBox</td>
<td>将字符串放入方框并显示出来的类. 实现了use方法和createClone方法</td>
</tr>
<tr>
<td>UnderlinePen</td>
<td>给字符串加上下划线并显示出来的类. 实现了use方法和createClone方法</td>
</tr>
<tr>
<td>Main</td>
<td>测试类</td>
</tr>
</tbody>
</table>
<p>实例程序类图:</p>
<img src="/2017/11/06/图解设计模式-第六章-Prototype模式/Prototype-Simple.png" alt="Prototype-Simple" title="Prototype-Simple">
<h4 id="Product接口"><a href="#Product接口" class="headerlink" title="Product接口"></a>Product接口</h4><p>Product接口是复制功能的接口, 继承了java.lang.Cloneable接口. 实现了该接口的实例可以调用clone方法来自动复制实例.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Product</span> <span class="keyword">extends</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span></span>;</div><div class="line">  <span class="function">Product <span class="title">createClone</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Manager类"><a href="#Manager类" class="headerlink" title="Manager类"></a>Manager类</h4><p>Manager类使用Product接口来复制实例.</p>
<p>showcase字段是java.util.HashMap类型. register方法将接收到的Product接口实例注册到showcase中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> HashMap showcase = <span class="keyword">new</span> HashMap();</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(String name, Product proto)</span> </span>&#123;</div><div class="line">    showcase.put(name, proto);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">create</span><span class="params">(String protoName)</span> </span>&#123;</div><div class="line">    Product p = (Product) showcase.get(protoName);</div><div class="line">    <span class="keyword">return</span> p.createClone();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="MessageBox类"><a href="#MessageBox类" class="headerlink" title="MessageBox类"></a>MessageBox类</h4><p>MessageBox类实现了Product接口. decochar字段保存了装饰方框那样的环绕字符串的字符. use方法会使用decochar字段中保存的字符把要显示的字符串框起来. createClone方法永远复制自己, 内部调用clone方法. 在复制时, 原来实例中的字段的值会被复制到新的实例中. 只有类自己(或子类)能够调用clone方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageBox</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> decochar;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MessageBox</span><span class="params">(<span class="keyword">char</span> decochar)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.decochar = decochar;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> length = s.getBytes().length;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length+<span class="number">4</span>; i++) &#123;</div><div class="line">      System.out.print(decochar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">    System.out.println(decochar + <span class="string">" "</span> + s + <span class="string">" "</span> + decochar);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length+<span class="number">4</span>; i++) &#123;</div><div class="line">      System.out.print(decochar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">createClone</span><span class="params">()</span> </span>&#123;</div><div class="line">    Product p = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      p = (Product) clone();</div><div class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="UnderlinePen类"><a href="#UnderlinePen类" class="headerlink" title="UnderlinePen类"></a>UnderlinePen类</h4><p>ulchar字段保存的是修饰下划线样式的字符. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UnderlinePen</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> ulchar;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">UnderlinePen</span><span class="params">(<span class="keyword">char</span> ulchar)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.ulchar = ulchar;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> length = s.getBytes().length;</div><div class="line">    System.out.println(<span class="string">"\""</span> + s + <span class="string">"\""</span>);</div><div class="line">    System.out.print(<span class="string">" "</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length; i++) &#123;</div><div class="line">      System.out.print(ulchar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">createClone</span><span class="params">()</span> </span>&#123;</div><div class="line">    Product p = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      p = (Product) clone();</div><div class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Manager manager = <span class="keyword">new</span> Manager();</div><div class="line">    UnderlinePen upen = <span class="keyword">new</span> UnderlinePen(<span class="string">"~"</span>);</div><div class="line">    MessageBox mbox = <span class="keyword">new</span> MessageBox(<span class="string">"*"</span>);</div><div class="line">    MessageBox sbox = <span class="keyword">new</span> MessageBox(<span class="string">"/"</span>);</div><div class="line">    manager.register(<span class="string">"strong message"</span>, upen);</div><div class="line">    manager.register(<span class="string">"warning box"</span>, mbox);</div><div class="line">    manager.register(<span class="string">"slash box"</span>, sbox);</div><div class="line">    </div><div class="line">    Product p1 = manager.create(<span class="string">"strong message"</span>);</div><div class="line">    p1.user(<span class="string">"Hello, world."</span>);</div><div class="line">    </div><div class="line">    Product p2 = manager.create(<span class="string">"warning box"</span>);</div><div class="line">    p2.user(<span class="string">"Hello, world."</span>);</div><div class="line">    </div><div class="line">    Product p3 = manager.create(<span class="string">"slash box"</span>);</div><div class="line">    p3.user(<span class="string">"Hello, world."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Prototype模式中的角色"><a href="#Prototype模式中的角色" class="headerlink" title="Prototype模式中的角色"></a>Prototype模式中的角色</h3><ul>
<li><p>Prototype(原型)</p>
<p>Product角色服装定义用于复制现有实例来生产新实例的方法.</p>
</li>
<li><p>ConcretePrototype(具体原型)</p>
<p>ConcretePrototype角色复制实现复制现有实例并生成新实例的方法.</p>
</li>
<li><p>Client(使用者)</p>
<p>Client角色复制使用复制实例的方法生成新实例</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/04/图解设计模式-第五章-Singleton模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/04/图解设计模式-第五章-Singleton模式/" itemprop="url">
                  图解设计模式-第五章-Singleton模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-04T19:51:59+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在想要达到以下目的: </p>
<ul>
<li>想确保任何情况下斗绝对只有一个实例</li>
<li>想在程序上表现出”只存在一个实例”</li>
</ul>
<p>像这样的确保只生成一个实例的模式称为Singleton模式.</p>
<p>Singleton模式类图</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第五章-Singleton模式/Singleton-Main.png" alt="Singleton-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>类的一览表</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Singleton</td>
<td>只存在一个实例的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序行为的类</td>
</tr>
</tbody>
</table>
<p>从Singleton模式类图中看到, 构造函数Singleton是private的. getInstance()方法是static的</p>
<h4 id="Singleton类"><a href="#Singleton类" class="headerlink" title="Singleton类"></a>Singleton类</h4><p>Singleton类只会生成一个实例, Singleton类定义了一个static字段singleton, 并将其出事后为Singleton类的实例.</p>
<p>Singleton类的构造函数是private的, 这是为了禁止从Singleton类外调用构造函数创建Singleton类的实例. </p>
<p>getInstance方法返回singleton实例.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton = <span class="keyword">new</span> Singleton();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> singleton;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">blic <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Singleton obj1 = Singleton.getInstance();</div><div class="line">        Singleton obj2 = Singleton.getInstance();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (obj1 == obj2)</div><div class="line">            System.out.println(<span class="string">"obj1和obj2是相同的实例"</span>);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            System.out.println(<span class="string">"obj1和obj2不是相同的实例"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Singleton模式中的角色"><a href="#Singleton模式中的角色" class="headerlink" title="Singleton模式中的角色"></a>Singleton模式中的角色</h3><ul>
<li><p>Singleton</p>
<p>只有一个返回唯一实例的static方法. 这个方法总是返回同一个实例.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/04/图解设计模式-第四章-FactoryMethod模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/04/图解设计模式-第四章-FactoryMethod模式/" itemprop="url">
                  图解设计模式-第四章-FactoryMethod模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-04T18:34:43+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用Template Method模式来构建生成实例的工厂, 这就是Factory Method 模式.</p>
<p>Factory Method模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第四章-FactoryMethod模式/FactoryMethod-Main.png" alt="FactoryMethod-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>作用是制作身份证(ID卡). 其中有5个类:</p>
<p>Product类和Factory类属于framework包, 这两个类组成生成实例的框架.</p>
<p>IDCard类和IDCardFactory类负责实际的加工处理, 它们属于idcard包.</p>
<p>Main类用于测试程序行为</p>
<p>实例程序类图<img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第四章-FactoryMethod模式/FactoryMethod-Simple.png" alt="FactoryMethod-Simple"></p>
<h4 id="Product类"><a href="#Product类" class="headerlink" title="Product类"></a>Product类</h4><p>用来表示”产品”, 仅声明了use抽象方法. use方法的实现交给Product类的子类负责.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Factory类"><a href="#Factory类" class="headerlink" title="Factory类"></a>Factory类</h4><p>使用Template Method模式. 声明了用于”生产产品”的createProduct抽象方法, 用于”注册产品”的registerProduct抽象方法. createProduct和registerProduct方法的具体处理都交给Factory类的子类负责.</p>
<p>create方法的实现是先调用createProduct方法生成产品, 接着调用registerProduct方法注册产品. </p>
<p>只要是Factory Method模式, 生成实例时就一定会使用到Template Method模式.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Product <span class="title">create</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        Product product = createProduct(owner);</div><div class="line"></div><div class="line">        registerProduct(product);</div><div class="line">        <span class="keyword">return</span> product;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Product <span class="title">createProduct</span><span class="params">(String owner)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">registerProduct</span><span class="params">(Product product)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="IDCard类"><a href="#IDCard类" class="headerlink" title="IDCard类"></a>IDCard类</h4><p>IDCard类时Product类的子类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IDCard</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String owner;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IDCard</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"制作"</span> + owner + <span class="string">"的ID卡"</span>);</div><div class="line">        <span class="keyword">this</span>.owner = owner;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"使用"</span> + owner + <span class="string">"的ID卡"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOwner</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> owner;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="IDCardFactory类"><a href="#IDCardFactory类" class="headerlink" title="IDCardFactory类"></a>IDCardFactory类</h4><p>IDCardFactory类实现了createProduct和registerProduct方法. </p>
<p>createProduct方法用来生成IDCard的实例</p>
<p>registerProduct方法通过将IDCard的owner保存到owners字段来实现注册产品</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IDCardFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; owners = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> Product <span class="title">createProduct</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> IDCard(owner);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">registerProduct</span><span class="params">(Product product)</span> </span>&#123;</div><div class="line">        owners.add(((IDCard)product).getOwner());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getOwners</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> owners;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Factory factory = <span class="keyword">new</span> IDCardFactory();</div><div class="line">        Product card1 = factory.create(<span class="string">"小明"</span>);</div><div class="line">        Product card2 = factory.create(<span class="string">"小红"</span>);</div><div class="line">        Product card3 = factory.create(<span class="string">"小刚"</span>);</div><div class="line">        card1.use();</div><div class="line">        card2.use();</div><div class="line">        card3.use();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Factory-Method模式中的角色"><a href="#Factory-Method模式中的角色" class="headerlink" title="Factory Method模式中的角色"></a>Factory Method模式中的角色</h3><ul>
<li><p>Product(产品)</p>
<p>一个抽象类, 定义了在Factory Method模式中生成的那些实例所持有的接口(API), 但具体处理由子类ConcreteProduct角色决定</p>
</li>
<li><p>Creator(创建者)</p>
<p>负责生成Product角色的抽象类. 具体处理由子类ConcreteCreator角色决定. Creator角色对ConcreteCreator角色一无所知, 只知道要调用Product角色和生成实例的方法. 不用new关键字来生成实例, 而是调用生成实力的专用方法来生成实例, 这样就可以防止父类与其它具体类耦合</p>
</li>
<li><p>ConcreteProduct(具体的产品)</p>
<p>决定具体的产品.</p>
</li>
<li><p>ConcreteCreator(具体的创建者)</p>
<p>负责生成具体的产品.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/02/图解设计模式-第三章-TemplateMethod模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/02/图解设计模式-第三章-TemplateMethod模式/" itemprop="url">
                  图解设计模式-第三章-TemplateMethod模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-02T21:57:54+08:00">
                2017-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Template Method模式是带有模板功能的模式, 组成模版的方法被定义在父类中. </p>
<p>由于这些方法是抽象方法, 在父类中无法知道这些方法最终会进行怎样的处理. 唯一知道的就是父类是如何调用这些方法的.</p>
<p>在父类中定义处理流程的框架, 在子类中实现具体处理的模式称为Template Method模式.</p>
<p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第三章-TemplateMethod模式/Main.png" alt="Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>一段将字符和字符串循环显示5次的程序</p>
<p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第三章-TemplateMethod模式/Main-sample.png" alt="Main-sample"></p>
<p>类一览表:</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AbstractDisplay</td>
<td>只实现display方法的抽象类</td>
</tr>
<tr>
<td>CharDisplay</td>
<td>实现了open,print,close方法的类</td>
</tr>
<tr>
<td>StringDisplay</td>
<td>实现了open,print,close方法的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序行为的类</td>
</tr>
</tbody>
</table>
<h4 id="AbstractDisplay类"><a href="#AbstractDisplay类" class="headerlink" title="AbstractDisplay类"></a>AbstractDisplay类</h4><p>AbstractDisplay类中定义了display方法, 方法中依次调用open, print, close方法. 这里, 调用抽象方法的display方法就是模版方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++) &#123;</div><div class="line">      print();</div><div class="line">    &#125;</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="CharDisplay类"><a href="#CharDisplay类" class="headerlink" title="CharDisplay类"></a>CharDisplay类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CharDisplay</span> <span class="keyword">extends</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> ch;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CharDisplay</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.ch = ch;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"&lt;&lt;"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(ch);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"&gt;&gt;"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="StringDisplay类"><a href="#StringDisplay类" class="headerlink" title="StringDisplay类"></a>StringDisplay类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringDisplay</span> <span class="keyword">extends</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> String string;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> width;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StringDisplay</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.string = string;</div><div class="line">    <span class="keyword">this</span>.width = string.getBytes().length;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"|"</span> + string + <span class="string">"|"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printLine</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"+"</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;width; i++) </div><div class="line">      System.out.print(<span class="string">"-"</span>);</div><div class="line">    System.out.println(<span class="string">"+"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    AbstractDisplay dl = <span class="keyword">new</span> CharDisplay(<span class="string">'H'</span>);</div><div class="line">    AbstractDisplay d2 = <span class="keyword">new</span> StringDisplay(<span class="string">"Hello, World"</span>);</div><div class="line">    dl.display();</div><div class="line">    d2.display();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Template-Method模式中的角色"><a href="#Template-Method模式中的角色" class="headerlink" title="Template Method模式中的角色"></a>Template Method模式中的角色</h3><ul>
<li><p>AbstractClass(抽象类)</p>
<p>负责实现模版方法, 声明在模版方法中使用到的抽象方法.</p>
</li>
<li><p>ConcreteClass(具体类)</p>
<p>负责实现抽象类中的抽象方法.</p>
</li>
</ul>
<p>优点: 父类中编写了算法, 因此无需在每个子类中再编写算法.</p>
<p>在Template Method模式中, 父类和子类是紧密联系, 共同工作的. 因此, 在子类中实现父类的抽象方法时, 必须理解这些抽象方法在父类中调用的时机.</p>
<p>就程序而言, 声明抽象方法时希望达到以下目的:</p>
<ul>
<li>期待子类去实现抽象方法</li>
<li>要求子类去实现抽象方法</li>
</ul>
<p>虽然将更多的方法的实现放在父类中会让子类变的轻松, 但同时也降低了子类的灵活性. 反之, 如果父类中实现的方法过少, 子类就会变得臃肿, 而且还会导致子类间的代码出现重复.</p>
<p>在Template Method模式中, 处理的流程被定义在父类中. 而具体的处理交给子类. 但对于”如何划分处理的级别, 哪些级别需要由父类负责”, 并没有定式. </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/01/图解设计模式-第二章-适配器模式(Adapter)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/01/图解设计模式-第二章-适配器模式(Adapter)/" itemprop="url">
                  图解设计模式-第二章-适配器模式(Adapter)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-01T20:28:14+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在程序世界中, 经常会存在现有程序无法直接使用, 需要做适当的交换才能使用的情况. 这种用于填补”现有程序”和”所需程序”之间差异的设计模式就是<strong>Adapter模式</strong></p>
<p>Adapter模式有两种: 1. 类适配器模式(使用继承), 2. 对象适配器模式(使用委托)</p>
<h4 id="类适配器模式类图"><a href="#类适配器模式类图" class="headerlink" title="类适配器模式类图"></a>类适配器模式类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Adapter-Class">/Adapter-Class.png)</p>
<h4 id="对象适配器模式类图"><a href="#对象适配器模式类图" class="headerlink" title="对象适配器模式类图"></a>对象适配器模式类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Object-Adapter2">/Object-Adapter2.png)</p>
<p>示例程序是一段将输入的字符串显示为(Hello)或者<code>*Hello*</code>的程序. 分别使用类适配器模式和对象适配器模式实现.</p>
<h3 id="类适配器模式"><a href="#类适配器模式" class="headerlink" title="类适配器模式"></a>类适配器模式</h3><p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Main">/Main.png)</p>
<h4 id="Banner类"><a href="#Banner类" class="headerlink" title="Banner类"></a>Banner类</h4><p>有将字符串用括号括起来的showWithParen方法, 和将字符串用*号括起来的showWithAster方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banner</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String string;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Banner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.string = string;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithParen</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"("</span>+string+<span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithAster</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"*"</span>+string+<span class="string">"*"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Print接口"><a href="#Print接口" class="headerlink" title="Print接口"></a>Print接口</h4><p>假设Print接口是”需求”接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PrintBanner类"><a href="#PrintBanner类" class="headerlink" title="PrintBanner类"></a>PrintBanner类</h4><p>printBanner类扮演适配器角色, 继承了Banner类, 同时实现了Print接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintBanner</span> <span class="keyword">extends</span> <span class="title">Banner</span> <span class="keyword">implements</span> <span class="title">Print</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintBanner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(string);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span> </span>&#123;</div><div class="line">        showWithParen();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span> </span>&#123;</div><div class="line">        showWithAster();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><p>通过扮演适配器角色的PrintBanner类来显示字符串.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Print p = <span class="keyword">new</span> PrintBanner(<span class="string">"hello"</span>);</div><div class="line">        p.printWeak();</div><div class="line">        p.printStrong();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于Main类的代码而言, Banner类, showWithParen方法和showWithAster方法被完全隐藏起来了. Main类并不知道PrintBanner类的具体实现. </p>
<h3 id="使用委托实现的适配器模式"><a href="#使用委托实现的适配器模式" class="headerlink" title="使用委托实现的适配器模式"></a>使用委托实现的适配器模式</h3><p>委托是指将某个方法中的实际处理交给其他实例的方法.</p>
<p>类图:<img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Object-Adapter">/Object-Adapter.png)</p>
<h4 id="Banner类-1"><a href="#Banner类-1" class="headerlink" title="Banner类"></a>Banner类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banner</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String string;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Banner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.string = string;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithParen</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"("</span>+string+<span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithAster</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"*"</span>+string+<span class="string">"*"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Print类"><a href="#Print类" class="headerlink" title="Print类"></a>Print类</h4><p>这里把Print改成类, 由于Java中一个类不能同时继承两个类. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PrintBanner类-1"><a href="#PrintBanner类-1" class="headerlink" title="PrintBanner类"></a>PrintBanner类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintBanner</span> <span class="keyword">extends</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Banner banner;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintBanner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.banner = <span class="keyword">new</span> Banner(string);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span> </span>&#123;</div><div class="line">        banner.showWithParen();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span> </span>&#123;</div><div class="line">        banner.showWithAster();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类-1"><a href="#Main类-1" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Print p = <span class="keyword">new</span> PrintBanner(<span class="string">"hello"</span>);</div><div class="line">        p.printWeak();</div><div class="line">        p.printStrong();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Adatper模式中的角色"><a href="#Adatper模式中的角色" class="headerlink" title="Adatper模式中的角色"></a>Adatper模式中的角色</h3><ul>
<li><p>Target(对象)</p>
<p>负责定义所需的方法. 即示例程序中的Print接口和Print类</p>
</li>
<li><p>Client(请求者)</p>
<p>负责使用Target角色所定义的方法进行具体处理. Main类</p>
</li>
<li><p>Adaptee(被适配)</p>
<p>Adaptee是一个豉油既定方法的角色, Banner类. 如果Adaptee中的方法和Target角色的方法相同, 就不需要Adapter角色了</p>
</li>
<li><p>Adapter(适配)</p>
<p>使用Adapter角色的方法来满足Target角色的需求, 这是Adapter模式的目的. PrintBanner类</p>
</li>
</ul>
<h3 id="什么时候使用适配器模式"><a href="#什么时候使用适配器模式" class="headerlink" title="什么时候使用适配器模式"></a>什么时候使用适配器模式</h3><p>Adapter模式会对现有的类进行适配, 生成新的类. 通过该模式可以很方便的创建需要的方法群.</p>
<ol>
<li>没有现成的代码</li>
<li>版本升级和兼容.</li>
</ol>
<p>当Adapter角色和Target角色的功能完全不同时, Adapter模式无法使用.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Blue" />
          <p class="site-author-name" itemprop="name">Blue</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">64</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Blue</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  






  





  

  

  

  

</body>
</html>
