<!doctype html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="Blue的博客">
<meta property="og:url" content="https://singthi4079.github.io/index.html">
<meta property="og:site_name" content="Blue的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Blue的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://singthi4079.github.io/"/>





  <title> Blue的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blue的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/13/图解设计模式-第十章-Strategy模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/13/图解设计模式-第十章-Strategy模式/" itemprop="url">
                  图解设计模式-第十章-Strategy模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-13T20:58:33+08:00">
                2017-11-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>无论什么程序, 其目的都是解决问题, 为了解决问题, 需要编写特定的算法. 使用Strategy模式可以整体地替换算法的实现部分. </p>
<p>能整体地替换算法, 以不同的算法解决同一个问题, 这种模式就是Strategy模式.</p>
<p><strong>Strategy模式类图</strong></p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第十章-Strategy模式/Strategy-Main.png" alt="Strategy-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是让电脑玩”猜拳”游戏.</p>
<p>第一种策略是: 如果这局猜拳获胜, 纳闷下一局也出一样的手势.</p>
<p>第二种策略是: 根据上一局的手势从概率上计算出下一局的手势.</p>
<h4 id="类和接口一览表"><a href="#类和接口一览表" class="headerlink" title="类和接口一览表"></a>类和接口一览表</h4><table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hand</td>
<td>表示猜拳游戏中的”手势”的类</td>
</tr>
<tr>
<td>Strategy</td>
<td>表示猜拳游戏中的策略的类</td>
</tr>
<tr>
<td>WinningStrategy</td>
<td>表示第一种策略的类</td>
</tr>
<tr>
<td>ProbStrategy</td>
<td>表示第二种策略的类</td>
</tr>
<tr>
<td>Player</td>
<td>表示进行猜拳游戏的选手的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试类</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第十章-Strategy模式/Strategy-Simple.png" alt="Strategy-Simple"></p>
<h4 id="Hand类"><a href="#Hand类" class="headerlink" title="Hand类"></a>Hand类</h4><p>用int表示所出的手势: 0表示石头, 1表示剪刀, 2表示布, 并将值保存在handValue字段中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">this</span>.handValue+!)%<span class="number">3</span> == h.handValue</div></pre></td></tr></table></figure>
<p>这个表达式表示: 如果this的手势值加上1后是h的手势值(例如: 如果this的手势是石头, 而h是剪刀, 或是this的手势是剪刀, 而h的是布, 或者this的手势是布, 而h的手势是石头), 那么判断this获胜.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hand</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_GUU = <span class="number">0</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_CHO = <span class="number">1</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> HANDVALUE_PAA = <span class="number">2</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Hand[] hand = &#123;</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_GUU),</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_CHO),</div><div class="line">            <span class="keyword">new</span> Hand(HANDVALUE_PAA)</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] name = &#123;</div><div class="line">            <span class="string">"石头"</span>, <span class="string">"剪刀"</span>, <span class="string">"布"</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> handValue;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Hand</span><span class="params">(<span class="keyword">int</span> handValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.handValue = handValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Hand <span class="title">getHand</span><span class="params">(<span class="keyword">int</span> handValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> hand[handValue];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isStrongerThen</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fight(h) == <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isWeakerThen</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fight(h) == -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">fight</span><span class="params">(Hand h)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == h) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">this</span>.handValue + <span class="number">1</span>)%<span class="number">3</span> == h.handValue) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name[handValue];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Stategy接口"><a href="#Stategy接口" class="headerlink" title="Stategy接口"></a>Stategy接口</h4><p>定义了猜拳策略的抽象方法的接口. </p>
<p>study方法的作用是学习”上一局的手势是否获胜了”. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="function">Hand <span class="title">nextHand</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="WinningStrategy类"><a href="#WinningStrategy类" class="headerlink" title="WinningStrategy类"></a>WinningStrategy类</h4><p>这个类的策略是: 如果上一局的手势获胜了, 则下一局的手势就与上一局相同. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WinningStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Random random;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> won = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">private</span> Hand prevHand;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WinningStrategy</span><span class="params">(<span class="keyword">int</span> seed)</span> </span>&#123;</div><div class="line">        random = <span class="keyword">new</span> Random(seed);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!won)</div><div class="line">            prevHand = Hand.getHand(random.nextInt(<span class="number">3</span>));</div><div class="line">        <span class="keyword">return</span> prevHand;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span> </span>&#123;</div><div class="line">        won = win;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ProbStrategy类"><a href="#ProbStrategy类" class="headerlink" title="ProbStrategy类"></a>ProbStrategy类</h4><p>这个类的策略是: 每种手势出现的概率会根据以前的猜拳结果二改变. </p>
<p>history字段是一个表, 用来根据过去的胜负来进行概率计算. 它是一个二维数组, 每个数组下标的意思如下:</p>
<p><code>history[上一句出的手势][这一局出的手势]</code></p>
<p>这个表达式的值越大, 表示过去的胜率越高. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProbStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Random random;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> prevHandValue = <span class="number">0</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> currentHandValue = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[][] history = &#123;</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">            &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, &#125;,</div><div class="line">    &#125;;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProbStrategy</span><span class="params">(<span class="keyword">int</span> seed)</span> </span>&#123;</div><div class="line">        random = <span class="keyword">new</span> Random(seed);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> bet = random.nextInt(getSum(currentHandValue));</div><div class="line">        <span class="keyword">int</span> handValue = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (bet &lt; history[currentHandValue][<span class="number">0</span>]) &#123;</div><div class="line">            handValue = <span class="number">0</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bet &lt; history[currentHandValue][<span class="number">0</span>] + history[currentHandValue][<span class="number">1</span>]) &#123;</div><div class="line">            handValue = <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            handValue = <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        prevHandValue = currentHandValue;</div><div class="line">        currentHandValue = handValue;</div><div class="line">        <span class="keyword">return</span> Hand.getHand(handValue);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getSum</span><span class="params">(<span class="keyword">int</span> currentHandValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; i++) &#123;</div><div class="line">            sum += history[currentHandValue][i];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">(<span class="keyword">boolean</span> win)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (win) &#123;</div><div class="line">            history[prevHandValue][currentHandValue]++;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            history[prevHandValue][(currentHandValue+<span class="number">1</span>)%<span class="number">3</span>]++;</div><div class="line">            history[prevHandValue][(currentHandValue+<span class="number">2</span>)%<span class="number">3</span>]++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Player类"><a href="#Player类" class="headerlink" title="Player类"></a>Player类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> Strategy strategy;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> winCount;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> loseCount;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> gameCount;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Player</span><span class="params">(String name, Strategy strategy)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.strategy = strategy;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Hand <span class="title">nextHand</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> strategy.nextHand();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">win</span><span class="params">()</span> </span>&#123;</div><div class="line">        strategy.study(<span class="keyword">true</span>);</div><div class="line">        winCount++;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lose</span><span class="params">()</span> </span>&#123;</div><div class="line">        strategy.study(<span class="keyword">false</span>);</div><div class="line">        loseCount++;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">even</span><span class="params">()</span> </span>&#123;</div><div class="line">        gameCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"["</span> + name + <span class="string">":"</span> + gameCount + <span class="string">" games, "</span> + winCount + <span class="string">" win, "</span> + loseCount + <span class="string">" lose]"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> seed1 = Integer.parseInt(<span class="string">"314"</span>);</div><div class="line">        <span class="keyword">int</span> seed2 = Integer.parseInt(<span class="string">"15"</span>);</div><div class="line"></div><div class="line">        Player player1 = <span class="keyword">new</span> Player(<span class="string">"Taro"</span>, <span class="keyword">new</span> WinningStrategy(seed1));</div><div class="line">        Player player2 = <span class="keyword">new</span> Player(<span class="string">"Hana"</span>, <span class="keyword">new</span> ProbStrategy(seed2));</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000</span>; i++) &#123;</div><div class="line">            Hand nextHand1 = player1.nextHand();</div><div class="line">            Hand nextHand2 = player2.nextHand();</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (nextHand1.isStrongerThen(nextHand2)) &#123;</div><div class="line">                System.out.println(<span class="string">"Winner: "</span> + player1);</div><div class="line">                player1.win();</div><div class="line">                player2.lose();</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nextHand2.isStrongerThen(nextHand1)) &#123;</div><div class="line">                System.out.println(<span class="string">"Winner:"</span> + player2);</div><div class="line">                player1.lose();</div><div class="line">                player2.win();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                System.out.println(<span class="string">"Even...."</span>);</div><div class="line">                player1.even();</div><div class="line">                player2.even();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"Total result: "</span>);</div><div class="line">        System.out.println(player1.toString());</div><div class="line">        System.out.println(player2.toString());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Strategy模式中的角色"><a href="#Strategy模式中的角色" class="headerlink" title="Strategy模式中的角色"></a>Strategy模式中的角色</h3><ul>
<li><p>Strategy(策略)</p>
<p>负责决定实现策略所必需的接口</p>
</li>
<li><p>ConcreteStrategy</p>
<p>负责实现Strategy角色的接口, 即负责实现具体的策略.</p>
</li>
<li><p>Context(上下文)</p>
<p>负责使用Strategy角色</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/09/图解设计模式-第九章-Bridge模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/09/图解设计模式-第九章-Bridge模式/" itemprop="url">
                  图解设计模式-第九章-Bridge模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-09T20:18:49+08:00">
                2017-11-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Bridge模式的作用是将两样东西连接起来, 它们分别是<strong>类的功能层次结构</strong>和<strong>类的实现层次结构</strong>.</p>
<p>类的层次结构的作用:</p>
<ul>
<li><p>希望增加新功能时</p>
<p>父类具有极本功能, 在子类中增加新的功能. 这就是”类的功能层次结构”</p>
</li>
<li><p>希望增加新的实现是</p>
<p>父类通过声明抽象方法来定义接口, 子类通过实现具体方法来实现接口. 这就是”类的实现层次结构”.</p>
</li>
<li><p>类层次结构的混杂与分离</p>
<p>当类的层次结构只有一层时, 功能层次结构与实现层次结构混杂在一个层次结构中. 这样容易使类的层次结构变得复杂, 也难以透彻理解类的层次结构.  因此需要将”类的功能层次结构”和”类的实现层次结构”分离为两个独立的类层次结构. </p>
</li>
</ul>
<p>Bridge模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第九章-Bridge模式/Bridge-Main.png" alt="Bridge-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>功能是 显示一些东西.</p>
<p>类的一览表:</p>
<table>
<thead>
<tr>
<th>在哪个层次结构</th>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>类的功能层次结构</td>
<td>Display</td>
<td>负责显示的类</td>
</tr>
<tr>
<td>类的功能层次结构</td>
<td>CountDisplay</td>
<td>增加了只显示规定次数功能的类</td>
</tr>
<tr>
<td>类的实现层次结构</td>
<td>DisplayImpl</td>
<td>负责显示的类</td>
</tr>
<tr>
<td>类的实现层次结构</td>
<td>StringDisplayImpl</td>
<td>用字符串显示的类</td>
</tr>
<tr>
<td></td>
<td>Main</td>
<td>测试程序</td>
</tr>
</tbody>
</table>
<p>实例程序类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第九章-Bridge模式/Bridge-Simple.png" alt="Bridge-Simple"></p>
<h4 id="Display类"><a href="#Display类" class="headerlink" title="Display类"></a>Display类</h4><p>负责显示一些东西的类. impl字段中保存的是实现Display类的具体功能的实例. impl字段即是类的两个层次结构的”桥梁”.</p>
<p>open是显示前的处理</p>
<p>print是显示处理</p>
<p>close是显示后的处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Display</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> DisplayImpl impl;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Display</span><span class="params">(DisplayImpl impl)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.impl = impl;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawOpen();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawPrint();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    impl.rawClose();</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> finla <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    print();</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="CountDisplay类"><a href="#CountDisplay类" class="headerlink" title="CountDisplay类"></a>CountDisplay类</h4><p>CountDisplay类在Display类的基础上增加了一个新的功能, 具有显示规定次数的功能.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountDisplay</span> <span class="keyword">extends</span> <span class="title">Display</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CountDisplay</span><span class="params">(DisplayImpl impl)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(impl);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">multiDisplay</span><span class="params">(<span class="keyword">int</span> times)</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;times; i++) &#123;</div><div class="line">      print();</div><div class="line">    &#125;</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="DisplayImpl类"><a href="#DisplayImpl类" class="headerlink" title="DisplayImpl类"></a>DisplayImpl类</h4><p>DisplayImpl类是抽象类, 声明了rawOpen, rawPrint, rawClose方法分别和Display类的open, print, close方法对应.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">DisplayImpl</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawOpen</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawPrint</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">rawClose</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="StringDisplay类"><a href="#StringDisplay类" class="headerlink" title="StringDisplay类"></a>StringDisplay类</h4><p>显示字符串的类. 继承DisplayImpl类, 作为其子类, 使用rawOpen, rawPrint. rawClose方法进行显示.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringDisplayImpl</span> <span class="keyword">extends</span> <span class="title">DisplayImpl</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> String string;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> width;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StringDisplayImpl</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.string = string;</div><div class="line">    <span class="keyword">this</span>.width = string.getBytes().length;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rawOpen</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"|"</span> + string + <span class="string">"|"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printLine</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"+"</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;width; i++) &#123;</div><div class="line">      System.out.println(<span class="string">"-"</span>);</div><div class="line">    &#125;</div><div class="line">    System.out.println(<span class="string">"+"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>DisplayImpl和StringDisplayImpl类相当于类的实现层次结构</p>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Display d1 = <span class="keyword">new</span> Display(<span class="keyword">new</span> StringDisplayImpl(<span class="string">"hello, world!"</span>));</div><div class="line">    CountDisplay c1 = <span class="keyword">new</span> countDisplay(<span class="keyword">new</span> StringDisplayImpl(<span class="string">"Hello, World."</span>));</div><div class="line">    </div><div class="line">    d1.display();</div><div class="line">    c1.display();</div><div class="line">    c1.multiDisplay(<span class="number">5</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Bridge模式中的角色"><a href="#Bridge模式中的角色" class="headerlink" title="Bridge模式中的角色"></a>Bridge模式中的角色</h3><ul>
<li><p>Abstraction(抽象化)</p>
<p>位于类的功能层次结构,  使用Implementor角色的方法定义了基本功能. 保存了Implementor角色的实例.</p>
</li>
<li><p>RefinedAbstraction(改善后的抽象化)</p>
<p>在Abstraction角色的基础上增加新的功能. </p>
</li>
<li><p>Implementor(实现者)</p>
<p>位于类的实现层次结构, 定义了用于实现Abstraction角色的接口方法. </p>
</li>
<li><p>ConcreteImplementor(具体的实现者)</p>
<p>负责实现implementor角色中定义的接口.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/08/图解设计模式-第八章-AbstractFactory模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/08/图解设计模式-第八章-AbstractFactory模式/" itemprop="url">
                  图解设计模式-第八章-AbstractFactory模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-08T20:23:35+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>抽象工厂模式并不关心零件的具体实现, 而是只关心接口. 仅适用改接口将零件组装成产品.</p>
<p>抽象工厂模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第八章-AbstractFactory模式/AbstractFactory-Main.png" alt="AbstractFactory-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是将带有层次关系的链接的集合制作成HTML文件. </p>
<h4 id="类的一览表"><a href="#类的一览表" class="headerlink" title="类的一览表"></a>类的一览表</h4><table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Factory</td>
<td>表示抽象工厂类</td>
</tr>
<tr>
<td>Item</td>
<td>方便统一处理Link和Tray的类</td>
</tr>
<tr>
<td>Link</td>
<td>抽象零件: 表示HTML的链接的类</td>
</tr>
<tr>
<td>Tray</td>
<td>抽象零件: 表示含有Link和Tray的类</td>
</tr>
<tr>
<td>Page</td>
<td>抽象零件: 表示HTML页面的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序</td>
</tr>
<tr>
<td>ListFactory</td>
<td>表示具体的工厂的类</td>
</tr>
<tr>
<td>ListLink</td>
<td>具体零件: 表示HTML的链接的类</td>
</tr>
<tr>
<td>ListTray</td>
<td>具体领奖: 表示含有Link和Tray的类</td>
</tr>
<tr>
<td>ListPage</td>
<td>具体零件: 表示HTML页面的类</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第八章-AbstractFactory模式/AbstractFactory-Simple.png" alt="AbstractFactory-Simple"></p>
<h4 id="Item类"><a href="#Item类" class="headerlink" title="Item类"></a>Item类</h4><p>Link类和Tray类的父类. 使得Link类和Tray类具有可替换性. caption字段表示项目的标题. </p>
<p>makeHTML方法是抽象方法, 需要子类实现这个方法. 返回HTML文件的内容.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String caption;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Item</span><span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.caption = caption;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">makeHTML</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Link类"><a href="#Link类" class="headerlink" title="Link类"></a>Link类</h4><p>是抽象地表示HTML的超链接的类. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String url;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Link</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">        <span class="keyword">this</span>.url = url;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Tray类"><a href="#Tray类" class="headerlink" title="Tray类"></a>Tray类</h4><p>表示一个含有多个Link类和Tray类的容器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Tray</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> ArrayList tray = <span class="keyword">new</span> ArrayList();</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tray</span> <span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span> </span>&#123;</div><div class="line">        tray.add(item);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Page类"><a href="#Page类" class="headerlink" title="Page类"></a>Page类</h4><p>抽象的表示HTML页面的类. 如果把Link和Tray比喻成抽象的零件, 那Page类就是抽象的产品. </p>
<p>output方法是一个简单的Template Method模式的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Page</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> String title;</div><div class="line">    <span class="keyword">protected</span> String author;</div><div class="line">    <span class="keyword">protected</span> ArrayList content = <span class="keyword">new</span> ArrayList();</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Page</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.title = title;</div><div class="line">        <span class="keyword">this</span>.author = author;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span> </span>&#123;</div><div class="line">        content.add(item);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            String fileName = title + <span class="string">".html"</span>;</div><div class="line">            Writer writer = <span class="keyword">new</span> FileWriter(fileName);</div><div class="line">            writer.write(<span class="keyword">this</span>.makeHTML());</div><div class="line">            writer.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">makeHTML</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Factory类"><a href="#Factory类" class="headerlink" title="Factory类"></a>Factory类</h4><p>getFactory方法可以根据类名生成具体的工厂实例. className指定为具体工厂对应的字符串.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Factory <span class="title">getFactory</span><span class="params">(String className)</span> </span>&#123;</div><div class="line">        Factory factory = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            factory = (Factory) Class.forName(className).newInstance();</div><div class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> factory;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Link <span class="title">createLink</span><span class="params">(String caption, String url)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Tray <span class="title">createTray</span><span class="params">(String caption)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Page <span class="title">createPage</span><span class="params">(String title, String author)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</div><div class="line">            System.out.println(<span class="string">"Usage: java Main class.name.of.ConcreteFactory"</span>);</div><div class="line">            System.out.println(<span class="string">"Example 1: java Main listfactory.ListFactyr"</span>);</div><div class="line">            System.out.println(<span class="string">"Example 2: java Main tablefactory.TableFactory"</span>);</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Factory factory = Factory.getFactory(args[<span class="number">0</span>]);</div><div class="line"></div><div class="line">        Link people = factory.createLink(<span class="string">"PeoPle: "</span>, <span class="string">"http://www.people.com.cn"</span>);</div><div class="line">        Link us_yahoo = factory.createLink(<span class="string">"Yahoo!: "</span>, <span class="string">"http://www.yahoo.com"</span>);</div><div class="line"></div><div class="line">        Tray trayNews = factory.createTray(<span class="string">"Links"</span>);</div><div class="line">        trayNews.add(people);</div><div class="line">        trayNews.add(us_yahoo);</div><div class="line"></div><div class="line">        Page page = factory.createPage(<span class="string">"LinkPage"</span>, <span class="string">"Blue"</span>);</div><div class="line">        page.add(trayNews);</div><div class="line">        page.output();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListFactory类"><a href="#ListFactory类" class="headerlink" title="ListFactory类"></a>ListFactory类</h4><p>具体的工程类. 实现Factory类的抽象方法. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Link <span class="title">createLink</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListLink(caption, url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Tray <span class="title">createTray</span><span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListTray(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Page <span class="title">createPage</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListPage(title, author);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListLink类"><a href="#ListLink类" class="headerlink" title="ListLink类"></a>ListLink类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListLink</span> <span class="keyword">extends</span> <span class="title">Link</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListLink</span><span class="params">(String caption, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption, url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"&lt;li&gt;&lt;a href=\""</span> + url + <span class="string">"\"&gt;"</span> + caption + <span class="string">"&lt;/a&gt;&lt;/li&gt;\n"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListTray类"><a href="#ListTray类" class="headerlink" title="ListTray类"></a>ListTray类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListTray</span> <span class="keyword">extends</span> <span class="title">Tray</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListTray</span> <span class="params">(String caption)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(caption);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">        buffer.append(<span class="string">"&lt;li&gt;\n"</span>);</div><div class="line">        buffer.append(caption + <span class="string">"\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;ul&gt;\n"</span>);</div><div class="line">        Iterator it = tray.iterator();</div><div class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">            Item item = (Item) it.next();</div><div class="line">            buffer.append(item.makeHTML());</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"&lt;/ul&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;/li&gt;\n"</span>);</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ListPage类"><a href="#ListPage类" class="headerlink" title="ListPage类"></a>ListPage类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListPage</span> <span class="keyword">extends</span> <span class="title">Page</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListPage</span><span class="params">(String title, String author)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(title, author);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">makeHTML</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">        buffer.append(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + title + <span class="string">"&lt;/title&gt;&lt;/head&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;body&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;h1&gt;"</span> + title + <span class="string">"&lt;/h1&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;ul&gt;\n"</span>);</div><div class="line">        Iterator it = content.iterator();</div><div class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">            Item item = (Item) it.next();</div><div class="line">            buffer.append(item.makeHTML());</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"&lt;/ul&gt;\n"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;hr&gt;&lt;address&gt;"</span> + author + <span class="string">"&lt;/address&gt;"</span>);</div><div class="line">        buffer.append(<span class="string">"&lt;/body&gt;&lt;/btml&gt;\n"</span>);</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Abstray-Factory模式中的角色"><a href="#Abstray-Factory模式中的角色" class="headerlink" title="Abstray Factory模式中的角色"></a>Abstray Factory模式中的角色</h3><ul>
<li><p>AbstractProduct(抽象产品)</p>
<p>负责定义AbstractFactory角色所生成的抽象零件盒产品的接口.</p>
</li>
<li><p>AbstractFactory(抽象工厂)</p>
<p>负责定义用于生成抽象产品的接口</p>
</li>
<li><p>Client(委托者)</p>
<p>仅会调用AbstractFactory角色和AbstractProduct角色的接口进行工作.</p>
</li>
<li><p>ConcreteProduct(具体产品)</p>
<p>负责实现AbstractProduct角色的接口.</p>
</li>
<li><p>ConcreteFactory(具体工厂)</p>
<p>负责实现AbstractFactory角色的接口</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/07/图解设计模式-第七章-Builder模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/07/图解设计模式-第七章-Builder模式/" itemprop="url">
                  图解设计模式-第七章-Builder模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-07T20:28:40+08:00">
                2017-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Builder模式用于组装具有复杂结构的实例.</p>
<p>Builder模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第七章-Builder模式/Builder-Main.png" alt="Builder-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是使用Builder模式编写”文档”. 文档具有以下结构:</p>
<ul>
<li>含有一个标题</li>
<li>含有几个字符串</li>
<li>含有条目项目</li>
</ul>
<p>Builder类中定义了决定文档结构的方法, Director类使用改方法编写一个具体的文档. </p>
<p>Builder是抽象类, 它并没有进行任何实际的处理. 仅仅声明了抽象方法. </p>
<p>TextBuilder类使用纯文本编写文档</p>
<p>HTMLBuilder类使用HTML编写文档</p>
<p>类的一览表:</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Builder</td>
<td>定义了决定文档结构的方法的抽象类</td>
</tr>
<tr>
<td>Director</td>
<td>编写一个文档的类</td>
</tr>
<tr>
<td>TextBuilder</td>
<td>使用纯文本编写文档的类</td>
</tr>
<tr>
<td>HTMLBuilder</td>
<td>使用HTML编写文档的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序</td>
</tr>
</tbody>
</table>
<h4 id="示例程序类图"><a href="#示例程序类图" class="headerlink" title="示例程序类图"></a>示例程序类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第七章-Builder模式/Builder-Simple.png" alt="Builder-Simple"></p>
<h4 id="Builder类"><a href="#Builder类" class="headerlink" title="Builder类"></a>Builder类</h4><p>makeTitle, makeString. makeItems方法分别是编写标题, 字符串, 条目的方法. close方法是完成文档的编写.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Director类"><a href="#Director类" class="headerlink" title="Director类"></a>Director类</h4><p>Director类使用Builder类中声明的方法来编写文档.</p>
<p>Director类的构造函数的参数是Builder类型. </p>
<p>construct方法是编写文档的方法. 调用这个方法后就会编写文档. construct方法中所使用的方法都试在Builder类中声明的方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Builder builder;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.builder = builder;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        builder.makeTitle(<span class="string">"Greeting"</span>);</div><div class="line">        builder.makeString(<span class="string">"从早上到下午 "</span>);</div><div class="line">        builder.makeItems(<span class="keyword">new</span> String[] &#123;</div><div class="line">                <span class="string">"早上好"</span>,</div><div class="line">                <span class="string">"下午好"</span></div><div class="line">        &#125;);</div><div class="line">        builder.makeString(<span class="string">"晚上"</span>);</div><div class="line">        builder.makeItems(<span class="keyword">new</span> String[] &#123;</div><div class="line">                <span class="string">"晚上好"</span>,</div><div class="line">                <span class="string">"晚安"</span>,</div><div class="line">                <span class="string">"再见"</span></div><div class="line">        &#125;);</div><div class="line">        builder.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="TextBuilder类"><a href="#TextBuilder类" class="headerlink" title="TextBuilder类"></a>TextBuilder类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">"==============================\n"</span>);</div><div class="line">        buffer.append(<span class="string">"["</span> + title +<span class="string">"]\n"</span>);</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">'*'</span> + str + <span class="string">"\n"</span>);</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (String item : items) &#123;</div><div class="line">            buffer.append(<span class="string">" ."</span> + item + <span class="string">"\n"</span>);</div><div class="line">        &#125;</div><div class="line">        buffer.append(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">        buffer.append(<span class="string">"==============================\n"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getResult</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> buffer.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="HTMLBuilder类"><a href="#HTMLBuilder类" class="headerlink" title="HTMLBuilder类"></a>HTMLBuilder类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTMLBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String fileName;</div><div class="line">    <span class="keyword">private</span> PrintWriter writer;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeTitle</span><span class="params">(String title)</span> </span>&#123;</div><div class="line">        fileName = title + <span class="string">".html"</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            writer = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> FileWriter(fileName));</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        writer.println(<span class="string">"&lt;html&gt;"</span> +</div><div class="line">                <span class="string">"&lt;head&gt;&lt;title&gt;"</span>+title+<span class="string">"&lt;/title&gt;&lt;/head&gt;"</span> +</div><div class="line">                <span class="string">"&lt;body&gt;"</span> +</div><div class="line">                <span class="string">"&lt;h1&gt;"</span>+title+<span class="string">"&lt;/h1&gt;"</span></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeString</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;p&gt;"</span> + str + <span class="string">"&lt;/p&gt;"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeItems</span><span class="params">(String[] items)</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;ul&gt;"</span>);</div><div class="line">        <span class="keyword">for</span> (String item : items) &#123;</div><div class="line">            writer.println(<span class="string">"&lt;li&gt;"</span>+item+<span class="string">"&lt;/li&gt;"</span>);</div><div class="line">        &#125;</div><div class="line">        writer.println(<span class="string">"&lt;/ul&gt;"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</div><div class="line">        writer.close();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getResult</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> fileName;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</div><div class="line">            usage();</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">"plain"</span>)) &#123;</div><div class="line">            TextBuilder textBuilder = <span class="keyword">new</span> TextBuilder();</div><div class="line">            Director director = <span class="keyword">new</span> Director(textBuilder);</div><div class="line">            director.construct();</div><div class="line">            String result = textBuilder.getResult();</div><div class="line">            System.out.println(result);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">"html"</span>)) &#123;</div><div class="line">            HTMLBuilder htmlBuilder = <span class="keyword">new</span> HTMLBuilder();</div><div class="line">            Director director = <span class="keyword">new</span> Director(htmlBuilder);</div><div class="line">            director.construct();</div><div class="line">            String fileName = htmlBuilder.getResult();</div><div class="line">            System.out.println(fileName + <span class="string">"文件编写完成"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            usage();</div><div class="line">            System.exit(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">usage</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Usage: java Main plain  编写纯文本文档"</span>);</div><div class="line">        System.out.println(<span class="string">"Usage: java Main html  编写HTML文档"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Builder模式中的角色"><a href="#Builder模式中的角色" class="headerlink" title="Builder模式中的角色"></a>Builder模式中的角色</h3><ul>
<li><p>Builder(建造者)</p>
<p>负责定义生成实例的接口. 准备了用于生成实例的方法.</p>
</li>
<li><p>ConcreteBuilder(具体的建造者)</p>
<p>负责实现Builder的接口. </p>
</li>
<li><p>Director(监工)</p>
<p>负责使用Builder角色的接口. 不依赖于具体的建造者(ConcreteBuilder). 只调用在Builder角色中定义的方法.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/06/图解设计模式-第六章-Prototype模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/06/图解设计模式-第六章-Prototype模式/" itemprop="url">
                  图解设计模式-第六章-Prototype模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-06T20:00:48+08:00">
                2017-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>根据实例原型, 实例模型来生成新的实例, 这就是Prototype模式.</p>
<p>Java可以使用clone创建实例的副本. </p>
<p>Prototype模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第五章-Prototype模式/Prototype-Main.png" alt="Prototype-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的功能是将字符串放入方框中下石出来或者加上下划线显示出来. </p>
<p>类和接口一览表</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Product</td>
<td>声明了抽象方法use和createClone的接口</td>
</tr>
<tr>
<td>Manager</td>
<td>调用createClone方法复制实例的类</td>
</tr>
<tr>
<td>MessageBox</td>
<td>将字符串放入方框并显示出来的类. 实现了use方法和createClone方法</td>
</tr>
<tr>
<td>UnderlinePen</td>
<td>给字符串加上下划线并显示出来的类. 实现了use方法和createClone方法</td>
</tr>
<tr>
<td>Main</td>
<td>测试类</td>
</tr>
</tbody>
</table>
<p>实例程序类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第五章-Prototype模式/Prototype-Simple.png" alt="Prototype-Simple"></p>
<h4 id="Product接口"><a href="#Product接口" class="headerlink" title="Product接口"></a>Product接口</h4><p>Product接口是复制功能的接口, 继承了java.lang.Cloneable接口. 实现了该接口的实例可以调用clone方法来自动复制实例.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Product</span> <span class="keyword">extends</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span></span>;</div><div class="line">  <span class="function">Product <span class="title">createClone</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Manager类"><a href="#Manager类" class="headerlink" title="Manager类"></a>Manager类</h4><p>Manager类使用Product接口来复制实例.</p>
<p>showcase字段是java.util.HashMap类型. register方法将接收到的Product接口实例注册到showcase中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> HashMap showcase = <span class="keyword">new</span> HashMap();</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(String name, Product proto)</span> </span>&#123;</div><div class="line">    showcase.put(name, proto);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">create</span><span class="params">(String protoName)</span> </span>&#123;</div><div class="line">    Product p = (Product) showcase.get(protoName);</div><div class="line">    <span class="keyword">return</span> p.createClone();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="MessageBox类"><a href="#MessageBox类" class="headerlink" title="MessageBox类"></a>MessageBox类</h4><p>MessageBox类实现了Product接口. decochar字段保存了装饰方框那样的环绕字符串的字符. use方法会使用decochar字段中保存的字符把要显示的字符串框起来. createClone方法永远复制自己, 内部调用clone方法. 在复制时, 原来实例中的字段的值会被复制到新的实例中. 只有类自己(或子类)能够调用clone方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageBox</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> decochar;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MessageBox</span><span class="params">(<span class="keyword">char</span> decochar)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.decochar = decochar;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> length = s.getBytes().length;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length+<span class="number">4</span>; i++) &#123;</div><div class="line">      System.out.print(decochar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">    System.out.println(decochar + <span class="string">" "</span> + s + <span class="string">" "</span> + decochar);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length+<span class="number">4</span>; i++) &#123;</div><div class="line">      System.out.print(decochar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">createClone</span><span class="params">()</span> </span>&#123;</div><div class="line">    Product p = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      p = (Product) clone();</div><div class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="UnderlinePen类"><a href="#UnderlinePen类" class="headerlink" title="UnderlinePen类"></a>UnderlinePen类</h4><p>ulchar字段保存的是修饰下划线样式的字符. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UnderlinePen</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> ulchar;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">UnderlinePen</span><span class="params">(<span class="keyword">char</span> ulchar)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.ulchar = ulchar;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> length = s.getBytes().length;</div><div class="line">    System.out.println(<span class="string">"\""</span> + s + <span class="string">"\""</span>);</div><div class="line">    System.out.print(<span class="string">" "</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;length; i++) &#123;</div><div class="line">      System.out.print(ulchar);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> Product <span class="title">createClone</span><span class="params">()</span> </span>&#123;</div><div class="line">    Product p = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      p = (Product) clone();</div><div class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Manager manager = <span class="keyword">new</span> Manager();</div><div class="line">    UnderlinePen upen = <span class="keyword">new</span> UnderlinePen(<span class="string">"~"</span>);</div><div class="line">    MessageBox mbox = <span class="keyword">new</span> MessageBox(<span class="string">"*"</span>);</div><div class="line">    MessageBox sbox = <span class="keyword">new</span> MessageBox(<span class="string">"/"</span>);</div><div class="line">    manager.register(<span class="string">"strong message"</span>, upen);</div><div class="line">    manager.register(<span class="string">"warning box"</span>, mbox);</div><div class="line">    manager.register(<span class="string">"slash box"</span>, sbox);</div><div class="line">    </div><div class="line">    Product p1 = manager.create(<span class="string">"strong message"</span>);</div><div class="line">    p1.user(<span class="string">"Hello, world."</span>);</div><div class="line">    </div><div class="line">    Product p2 = manager.create(<span class="string">"warning box"</span>);</div><div class="line">    p2.user(<span class="string">"Hello, world."</span>);</div><div class="line">    </div><div class="line">    Product p3 = manager.create(<span class="string">"slash box"</span>);</div><div class="line">    p3.user(<span class="string">"Hello, world."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Prototype模式中的角色"><a href="#Prototype模式中的角色" class="headerlink" title="Prototype模式中的角色"></a>Prototype模式中的角色</h3><ul>
<li><p>Prototype(原型)</p>
<p>Product角色服装定义用于复制现有实例来生产新实例的方法.</p>
</li>
<li><p>ConcretePrototype(具体原型)</p>
<p>ConcretePrototype角色复制实现复制现有实例并生成新实例的方法.</p>
</li>
<li><p>Client(使用者)</p>
<p>Client角色复制使用复制实例的方法生成新实例</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/04/图解设计模式-第五章-Singleton模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/04/图解设计模式-第五章-Singleton模式/" itemprop="url">
                  图解设计模式-第五章-Singleton模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-04T19:51:59+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在想要达到以下目的: </p>
<ul>
<li>想确保任何情况下斗绝对只有一个实例</li>
<li>想在程序上表现出”只存在一个实例”</li>
</ul>
<p>像这样的确保只生成一个实例的模式称为Singleton模式.</p>
<p>Singleton模式类图</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第五章-Singleton模式/Singleton-Main.png" alt="Singleton-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>类的一览表</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Singleton</td>
<td>只存在一个实例的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序行为的类</td>
</tr>
</tbody>
</table>
<p>从Singleton模式类图中看到, 构造函数Singleton是private的. getInstance()方法是static的</p>
<h4 id="Singleton类"><a href="#Singleton类" class="headerlink" title="Singleton类"></a>Singleton类</h4><p>Singleton类只会生成一个实例, Singleton类定义了一个static字段singleton, 并将其出事后为Singleton类的实例.</p>
<p>Singleton类的构造函数是private的, 这是为了禁止从Singleton类外调用构造函数创建Singleton类的实例. </p>
<p>getInstance方法返回singleton实例.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton = <span class="keyword">new</span> Singleton();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> singleton;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">blic <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Singleton obj1 = Singleton.getInstance();</div><div class="line">        Singleton obj2 = Singleton.getInstance();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (obj1 == obj2)</div><div class="line">            System.out.println(<span class="string">"obj1和obj2是相同的实例"</span>);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            System.out.println(<span class="string">"obj1和obj2不是相同的实例"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Singleton模式中的角色"><a href="#Singleton模式中的角色" class="headerlink" title="Singleton模式中的角色"></a>Singleton模式中的角色</h3><ul>
<li><p>Singleton</p>
<p>只有一个返回唯一实例的static方法. 这个方法总是返回同一个实例.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/04/图解设计模式-第四章-FactoryMethod模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/04/图解设计模式-第四章-FactoryMethod模式/" itemprop="url">
                  图解设计模式-第四章-FactoryMethod模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-04T18:34:43+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用Template Method模式来构建生成实例的工厂, 这就是Factory Method 模式.</p>
<p>Factory Method模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第四章-FactoryMethod模式/FactoryMethod-Main.png" alt="FactoryMethod-Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>作用是制作身份证(ID卡). 其中有5个类:</p>
<p>Product类和Factory类属于framework包, 这两个类组成生成实例的框架.</p>
<p>IDCard类和IDCardFactory类负责实际的加工处理, 它们属于idcard包.</p>
<p>Main类用于测试程序行为</p>
<p>实例程序类图<img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第四章-FactoryMethod模式/FactoryMethod-Simple.png" alt="FactoryMethod-Simple"></p>
<h4 id="Product类"><a href="#Product类" class="headerlink" title="Product类"></a>Product类</h4><p>用来表示”产品”, 仅声明了use抽象方法. use方法的实现交给Product类的子类负责.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Factory类"><a href="#Factory类" class="headerlink" title="Factory类"></a>Factory类</h4><p>使用Template Method模式. 声明了用于”生产产品”的createProduct抽象方法, 用于”注册产品”的registerProduct抽象方法. createProduct和registerProduct方法的具体处理都交给Factory类的子类负责.</p>
<p>create方法的实现是先调用createProduct方法生成产品, 接着调用registerProduct方法注册产品. </p>
<p>只要是Factory Method模式, 生成实例时就一定会使用到Template Method模式.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Product <span class="title">create</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        Product product = createProduct(owner);</div><div class="line"></div><div class="line">        registerProduct(product);</div><div class="line">        <span class="keyword">return</span> product;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Product <span class="title">createProduct</span><span class="params">(String owner)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">registerProduct</span><span class="params">(Product product)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="IDCard类"><a href="#IDCard类" class="headerlink" title="IDCard类"></a>IDCard类</h4><p>IDCard类时Product类的子类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IDCard</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String owner;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IDCard</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"制作"</span> + owner + <span class="string">"的ID卡"</span>);</div><div class="line">        <span class="keyword">this</span>.owner = owner;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"使用"</span> + owner + <span class="string">"的ID卡"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOwner</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> owner;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="IDCardFactory类"><a href="#IDCardFactory类" class="headerlink" title="IDCardFactory类"></a>IDCardFactory类</h4><p>IDCardFactory类实现了createProduct和registerProduct方法. </p>
<p>createProduct方法用来生成IDCard的实例</p>
<p>registerProduct方法通过将IDCard的owner保存到owners字段来实现注册产品</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IDCardFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; owners = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> Product <span class="title">createProduct</span><span class="params">(String owner)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> IDCard(owner);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">registerProduct</span><span class="params">(Product product)</span> </span>&#123;</div><div class="line">        owners.add(((IDCard)product).getOwner());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getOwners</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> owners;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Factory factory = <span class="keyword">new</span> IDCardFactory();</div><div class="line">        Product card1 = factory.create(<span class="string">"小明"</span>);</div><div class="line">        Product card2 = factory.create(<span class="string">"小红"</span>);</div><div class="line">        Product card3 = factory.create(<span class="string">"小刚"</span>);</div><div class="line">        card1.use();</div><div class="line">        card2.use();</div><div class="line">        card3.use();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Factory-Method模式中的角色"><a href="#Factory-Method模式中的角色" class="headerlink" title="Factory Method模式中的角色"></a>Factory Method模式中的角色</h3><ul>
<li><p>Product(产品)</p>
<p>一个抽象类, 定义了在Factory Method模式中生成的那些实例所持有的接口(API), 但具体处理由子类ConcreteProduct角色决定</p>
</li>
<li><p>Creator(创建者)</p>
<p>负责生成Product角色的抽象类. 具体处理由子类ConcreteCreator角色决定. Creator角色对ConcreteCreator角色一无所知, 只知道要调用Product角色和生成实例的方法. 不用new关键字来生成实例, 而是调用生成实力的专用方法来生成实例, 这样就可以防止父类与其它具体类耦合</p>
</li>
<li><p>ConcreteProduct(具体的产品)</p>
<p>决定具体的产品.</p>
</li>
<li><p>ConcreteCreator(具体的创建者)</p>
<p>负责生成具体的产品.</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/02/图解设计模式-第三章-TemplateMethod模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/02/图解设计模式-第三章-TemplateMethod模式/" itemprop="url">
                  图解设计模式-第三章-TemplateMethod模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-02T21:57:54+08:00">
                2017-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Template Method模式是带有模板功能的模式, 组成模版的方法被定义在父类中. </p>
<p>由于这些方法是抽象方法, 在父类中无法知道这些方法最终会进行怎样的处理. 唯一知道的就是父类是如何调用这些方法的.</p>
<p>在父类中定义处理流程的框架, 在子类中实现具体处理的模式称为Template Method模式.</p>
<p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第三章-TemplateMethod模式/Main.png" alt="Main"></p>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>一段将字符和字符串循环显示5次的程序</p>
<p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第三章-TemplateMethod模式/Main-sample.png" alt="Main-sample"></p>
<p>类一览表:</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AbstractDisplay</td>
<td>只实现display方法的抽象类</td>
</tr>
<tr>
<td>CharDisplay</td>
<td>实现了open,print,close方法的类</td>
</tr>
<tr>
<td>StringDisplay</td>
<td>实现了open,print,close方法的类</td>
</tr>
<tr>
<td>Main</td>
<td>测试程序行为的类</td>
</tr>
</tbody>
</table>
<h4 id="AbstractDisplay类"><a href="#AbstractDisplay类" class="headerlink" title="AbstractDisplay类"></a>AbstractDisplay类</h4><p>AbstractDisplay类中定义了display方法, 方法中依次调用open, print, close方法. 这里, 调用抽象方法的display方法就是模版方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">    open();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++) &#123;</div><div class="line">      print();</div><div class="line">    &#125;</div><div class="line">    close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="CharDisplay类"><a href="#CharDisplay类" class="headerlink" title="CharDisplay类"></a>CharDisplay类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CharDisplay</span> <span class="keyword">extends</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">char</span> ch;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CharDisplay</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.ch = ch;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"&lt;&lt;"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(ch);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"&gt;&gt;"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="StringDisplay类"><a href="#StringDisplay类" class="headerlink" title="StringDisplay类"></a>StringDisplay类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringDisplay</span> <span class="keyword">extends</span> <span class="title">AbstractDisplay</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> String string;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> width;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StringDisplay</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.string = string;</div><div class="line">    <span class="keyword">this</span>.width = string.getBytes().length;</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"|"</span> + string + <span class="string">"|"</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</div><div class="line">    printLine();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printLine</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.print(<span class="string">"+"</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;width; i++) </div><div class="line">      System.out.print(<span class="string">"-"</span>);</div><div class="line">    System.out.println(<span class="string">"+"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    AbstractDisplay dl = <span class="keyword">new</span> CharDisplay(<span class="string">'H'</span>);</div><div class="line">    AbstractDisplay d2 = <span class="keyword">new</span> StringDisplay(<span class="string">"Hello, World"</span>);</div><div class="line">    dl.display();</div><div class="line">    d2.display();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Template-Method模式中的角色"><a href="#Template-Method模式中的角色" class="headerlink" title="Template Method模式中的角色"></a>Template Method模式中的角色</h3><ul>
<li><p>AbstractClass(抽象类)</p>
<p>负责实现模版方法, 声明在模版方法中使用到的抽象方法.</p>
</li>
<li><p>ConcreteClass(具体类)</p>
<p>负责实现抽象类中的抽象方法.</p>
</li>
</ul>
<p>优点: 父类中编写了算法, 因此无需在每个子类中再编写算法.</p>
<p>在Template Method模式中, 父类和子类是紧密联系, 共同工作的. 因此, 在子类中实现父类的抽象方法时, 必须理解这些抽象方法在父类中调用的时机.</p>
<p>就程序而言, 声明抽象方法时希望达到以下目的:</p>
<ul>
<li>期待子类去实现抽象方法</li>
<li>要求子类去实现抽象方法</li>
</ul>
<p>虽然将更多的方法的实现放在父类中会让子类变的轻松, 但同时也降低了子类的灵活性. 反之, 如果父类中实现的方法过少, 子类就会变得臃肿, 而且还会导致子类间的代码出现重复.</p>
<p>在Template Method模式中, 处理的流程被定义在父类中. 而具体的处理交给子类. 但对于”如何划分处理的级别, 哪些级别需要由父类负责”, 并没有定式. </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/11/01/图解设计模式-第二章-适配器模式(Adapter)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/01/图解设计模式-第二章-适配器模式(Adapter)/" itemprop="url">
                  图解设计模式-第二章-适配器模式(Adapter)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-01T20:28:14+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在程序世界中, 经常会存在现有程序无法直接使用, 需要做适当的交换才能使用的情况. 这种用于填补”现有程序”和”所需程序”之间差异的设计模式就是<strong>Adapter模式</strong></p>
<p>Adapter模式有两种: 1. 类适配器模式(使用继承), 2. 对象适配器模式(使用委托)</p>
<h4 id="类适配器模式类图"><a href="#类适配器模式类图" class="headerlink" title="类适配器模式类图"></a>类适配器模式类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Adapter-Class">/Adapter-Class.png)</p>
<h4 id="对象适配器模式类图"><a href="#对象适配器模式类图" class="headerlink" title="对象适配器模式类图"></a>对象适配器模式类图</h4><p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Object-Adapter2">/Object-Adapter2.png)</p>
<p>示例程序是一段将输入的字符串显示为(Hello)或者<code>*Hello*</code>的程序. 分别使用类适配器模式和对象适配器模式实现.</p>
<h3 id="类适配器模式"><a href="#类适配器模式" class="headerlink" title="类适配器模式"></a>类适配器模式</h3><p>类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Main">/Main.png)</p>
<h4 id="Banner类"><a href="#Banner类" class="headerlink" title="Banner类"></a>Banner类</h4><p>有将字符串用括号括起来的showWithParen方法, 和将字符串用*号括起来的showWithAster方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banner</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String string;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Banner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.string = string;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithParen</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"("</span>+string+<span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithAster</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"*"</span>+string+<span class="string">"*"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Print接口"><a href="#Print接口" class="headerlink" title="Print接口"></a>Print接口</h4><p>假设Print接口是”需求”接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PrintBanner类"><a href="#PrintBanner类" class="headerlink" title="PrintBanner类"></a>PrintBanner类</h4><p>printBanner类扮演适配器角色, 继承了Banner类, 同时实现了Print接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintBanner</span> <span class="keyword">extends</span> <span class="title">Banner</span> <span class="keyword">implements</span> <span class="title">Print</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintBanner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(string);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span> </span>&#123;</div><div class="line">        showWithParen();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span> </span>&#123;</div><div class="line">        showWithAster();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类"><a href="#Main类" class="headerlink" title="Main类"></a>Main类</h4><p>通过扮演适配器角色的PrintBanner类来显示字符串.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Print p = <span class="keyword">new</span> PrintBanner(<span class="string">"hello"</span>);</div><div class="line">        p.printWeak();</div><div class="line">        p.printStrong();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于Main类的代码而言, Banner类, showWithParen方法和showWithAster方法被完全隐藏起来了. Main类并不知道PrintBanner类的具体实现. </p>
<h3 id="使用委托实现的适配器模式"><a href="#使用委托实现的适配器模式" class="headerlink" title="使用委托实现的适配器模式"></a>使用委托实现的适配器模式</h3><p>委托是指将某个方法中的实际处理交给其他实例的方法.</p>
<p>类图:<img src="/Users/storm/workspace/notes/source/_posts/图解设计模式-第二章-适配器模式(Adapter" alt="Object-Adapter">/Object-Adapter.png)</p>
<h4 id="Banner类-1"><a href="#Banner类-1" class="headerlink" title="Banner类"></a>Banner类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banner</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String string;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Banner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.string = string;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithParen</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"("</span>+string+<span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showWithAster</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"*"</span>+string+<span class="string">"*"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Print类"><a href="#Print类" class="headerlink" title="Print类"></a>Print类</h4><p>这里把Print改成类, 由于Java中一个类不能同时继承两个类. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PrintBanner类-1"><a href="#PrintBanner类-1" class="headerlink" title="PrintBanner类"></a>PrintBanner类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintBanner</span> <span class="keyword">extends</span> <span class="title">Print</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Banner banner;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintBanner</span><span class="params">(String string)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.banner = <span class="keyword">new</span> Banner(string);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printWeak</span><span class="params">()</span> </span>&#123;</div><div class="line">        banner.showWithParen();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printStrong</span><span class="params">()</span> </span>&#123;</div><div class="line">        banner.showWithAster();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Main类-1"><a href="#Main类-1" class="headerlink" title="Main类"></a>Main类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Print p = <span class="keyword">new</span> PrintBanner(<span class="string">"hello"</span>);</div><div class="line">        p.printWeak();</div><div class="line">        p.printStrong();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Adatper模式中的角色"><a href="#Adatper模式中的角色" class="headerlink" title="Adatper模式中的角色"></a>Adatper模式中的角色</h3><ul>
<li><p>Target(对象)</p>
<p>负责定义所需的方法. 即示例程序中的Print接口和Print类</p>
</li>
<li><p>Client(请求者)</p>
<p>负责使用Target角色所定义的方法进行具体处理. Main类</p>
</li>
<li><p>Adaptee(被适配)</p>
<p>Adaptee是一个豉油既定方法的角色, Banner类. 如果Adaptee中的方法和Target角色的方法相同, 就不需要Adapter角色了</p>
</li>
<li><p>Adapter(适配)</p>
<p>使用Adapter角色的方法来满足Target角色的需求, 这是Adapter模式的目的. PrintBanner类</p>
</li>
</ul>
<h3 id="什么时候使用适配器模式"><a href="#什么时候使用适配器模式" class="headerlink" title="什么时候使用适配器模式"></a>什么时候使用适配器模式</h3><p>Adapter模式会对现有的类进行适配, 生成新的类. 通过该模式可以很方便的创建需要的方法群.</p>
<ol>
<li>没有现成的代码</li>
<li>版本升级和兼容.</li>
</ol>
<p>当Adapter角色和Target角色的功能完全不同时, Adapter模式无法使用.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://singthi4079.github.io/2017/10/31/图解设计模式第一章-Iterator模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Blue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blue的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/31/图解设计模式第一章-Iterator模式/" itemprop="url">
                  图解设计模式第一章-Iterator模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-31T21:09:09+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Iterator模式用于在数据集合中按照顺序遍历集合.</p>
<p>Iterator模式类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式第一章-Iterator模式/Iterator.png" alt="Iterator"></p>
<ul>
<li><p>Iterator(迭代器)</p>
<p>定义按顺序逐个遍历元素的接口. 定义了hasNext和next方法. hasNext方法用于判断是否存在下一个元素, next方法用于获取该元素</p>
</li>
<li><p>ConcreteIterator(具体的迭代器)</p>
<p>负责实现Iterator角色锁定义的接口. 包含了遍历集合所必需的信息.</p>
</li>
<li><p>Aggregate(集合)</p>
<p>负责定义创建Iterator角色的接口. 这个接口只有一个方法, 会查创建”按顺序访问保存在我内部元素的人”. 定义了iterator方法</p>
</li>
<li><p>ConcreteAggragate(具体的集合)</p>
<p>负责实现Aggragate接口所定义的接口. 会创建具体的Iterator角色. </p>
</li>
</ul>
<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><p>示例程序的作用是将书(Book)放置到书架(BookShelf)中, 并将书的名字按顺序显示出来.</p>
<table>
<thead>
<tr>
<th style="text-align:center">名字</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Aggregate</td>
<td style="text-align:center">表示集合的接口</td>
</tr>
<tr>
<td style="text-align:center">Iterator</td>
<td style="text-align:center">遍历集合的接口</td>
</tr>
<tr>
<td style="text-align:center">Book</td>
<td style="text-align:center">表示书的类</td>
</tr>
<tr>
<td style="text-align:center">BookShelf</td>
<td style="text-align:center">表示书架的类</td>
</tr>
<tr>
<td style="text-align:center">BookShelfIterator</td>
<td style="text-align:center">遍历书架的类</td>
</tr>
<tr>
<td style="text-align:center">Main</td>
<td style="text-align:center">测试程序行为的类</td>
</tr>
</tbody>
</table>
<p>示例程序类图:</p>
<p><img src="/Users/storm/workspace/notes/source/_posts/图解设计模式第一章-Iterator模式/Iterator-Concrete.png" alt="Iterator-Concrete"></p>
<p>代码实现:</p>
<blockquote>
<p>Aggregate接口</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Arrgegate接口是所要遍历的集合的接口, 实现了这个接口的类将成为一个可以保存多个元素的集合, 就像数组一样</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Aggregate</span> </span>&#123;</div><div class="line">    <span class="function">Iterator <span class="title">iterator</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Iterator接口</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 用于遍历集合中元素的, 起作用相当于循环语句中的循环变量.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 判断是否存在下一个元素</div><div class="line">     * 存在下一个元素返回true, 不存在返回false</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取下一个元素</div><div class="line">     * 为了能够在下次调用next方法时正确的返回下一个元素, 这个方法还隐含将迭代器移动到下一个元素的处理.</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function">Object <span class="title">next</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Book类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 表示书的类, 只有一个getName方法, 返回书的名字</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>BookShelf类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 表示书架的类, 作为集合处理, 实现Aggregate接口.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookShelf</span> <span class="keyword">implements</span> <span class="title">Aggregate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Book[] books;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> last = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookShelf</span><span class="params">(<span class="keyword">int</span> maxSize)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.books = <span class="keyword">new</span> Book[maxSize];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">getBookAt</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> books[index];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">appendBook</span><span class="params">(Book book)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.books[last] = book;</div><div class="line">        last++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLength</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> last;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Iterator <span class="title">iterator</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BookShelfIterator(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>BookShelfIterator类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 遍历书架的类</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookShelfIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> BookShelf bookShelf;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> index;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookShelfIterator</span><span class="params">(BookShelf bookShelf)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.bookShelf = bookShelf;</div><div class="line">        <span class="keyword">this</span>.index = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> index &lt; bookShelf.getLength();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">        Book book = bookShelf.getBookAt(index);</div><div class="line">        index++;</div><div class="line">        <span class="keyword">return</span> book;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Main类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        BookShelf bookShelf = <span class="keyword">new</span> BookShelf(<span class="number">4</span>);</div><div class="line">        bookShelf.appendBook(<span class="keyword">new</span> Book(<span class="string">"Around the World in 80 Days"</span>));</div><div class="line">        bookShelf.appendBook(<span class="keyword">new</span> Book(<span class="string">"Bible"</span>));</div><div class="line">        bookShelf.appendBook(<span class="keyword">new</span> Book(<span class="string">"Cinderella"</span>));</div><div class="line">        bookShelf.appendBook(<span class="keyword">new</span> Book(<span class="string">"Daddy Long legs"</span>));</div><div class="line"></div><div class="line">        Iterator it = bookShelf.iterator();</div><div class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">            Book book = (Book) it.next();</div><div class="line">            System.out.println(book.getName());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="为什么要使用Iterator"><a href="#为什么要使用Iterator" class="headerlink" title="为什么要使用Iterator"></a>为什么要使用Iterator</h4><p>引入Iterator后, 可以将遍历与实现分离. 看如下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">	Book book = (Book) it.next();</div><div class="line">	System.out.println(book.getName());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里的while循环不依赖于BookShelf的实现. </p>
<h4 id="next方法"><a href="#next方法" class="headerlink" title="next方法"></a>next方法</h4><p>next方法表示: 返回当前元素, 并指向下一个元素</p>
<p>可以根据一个ConcreteAggregate角色编写多个ConcreteIterator角色</p>
<p>遍历的方法是多种多样的:</p>
<ul>
<li>从最后开始向前遍历</li>
<li>即可以前向后遍历, 也可以从后向前遍历</li>
<li>指定下标进行”跳跃式”遍历</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Blue" />
          <p class="site-author-name" itemprop="name">Blue</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">63</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Blue</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  






  





  

  

  

  

</body>
</html>
